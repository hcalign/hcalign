2024-08-20 02:31:24,818:INFO: device: cuda:3 n_gpu: 4
2024-08-20 02:31:24,825:INFO: device: cuda:1 n_gpu: 4
2024-08-20 02:31:24,831:INFO: Effective parameters:
2024-08-20 02:31:24,831:INFO:   <<< batch_size: 256
2024-08-20 02:31:24,831:INFO:   <<< batch_size_val: 48
2024-08-20 02:31:24,831:INFO:   <<< btm_mode: all
2024-08-20 02:31:24,831:INFO:   <<< cache_dir: 
2024-08-20 02:31:24,831:INFO:   <<< cc_cluster_iteration: 10
2024-08-20 02:31:24,831:INFO:   <<< cc_msl_weight: 0.5
2024-08-20 02:31:24,831:INFO:   <<< cc_neg_mine_ratio: 3
2024-08-20 02:31:24,831:INFO:   <<< cc_num_prototypes: 1000
2024-08-20 02:31:24,831:INFO:   <<< cc_sample_frames: 4
2024-08-20 02:31:24,831:INFO:   <<< cc_selection_thresh: 0.7
2024-08-20 02:31:24,831:INFO:   <<< cc_start_epoch: 1
2024-08-20 02:31:24,831:INFO:   <<< cc_task: MSL
2024-08-20 02:31:24,831:INFO:   <<< coef_lr: 0.0001
2024-08-20 02:31:24,831:INFO:   <<< cross_model: cross-base
2024-08-20 02:31:24,831:INFO:   <<< cross_num_hidden_layers: 4
2024-08-20 02:31:24,831:INFO:   <<< data_path: data/MSRVTT/MSRVTT_data.json
2024-08-20 02:31:24,832:INFO:   <<< datatype: msrvtt
2024-08-20 02:31:24,832:INFO:   <<< do_eval: False
2024-08-20 02:31:24,832:INFO:   <<< do_lower_case: False
2024-08-20 02:31:24,832:INFO:   <<< do_pretrain: False
2024-08-20 02:31:24,832:INFO:   <<< do_train: True
2024-08-20 02:31:24,832:INFO:   <<< epochs: 5
2024-08-20 02:31:24,832:INFO:   <<< eval_frame_order: 0
2024-08-20 02:31:24,832:INFO:   <<< expand_msrvtt_sentences: True
2024-08-20 02:31:24,832:INFO:   <<< feature_framerate: 1
2024-08-20 02:31:24,832:INFO:   <<< features_path: /data1/dengrui/data/MSR-VTT/videos_compressed/
2024-08-20 02:31:24,832:INFO:   <<< fp16: False
2024-08-20 02:31:24,832:INFO:   <<< fp16_opt_level: O1
2024-08-20 02:31:24,832:INFO:   <<< freeze_layer_num: 0
2024-08-20 02:31:24,832:INFO:   <<< gradient_accumulation_steps: 1
2024-08-20 02:31:24,832:INFO:   <<< hard_negative_rate: 0.5
2024-08-20 02:31:24,832:INFO:   <<< init_model: None
2024-08-20 02:31:24,832:INFO:   <<< linear_patch: 2d
2024-08-20 02:31:24,832:INFO:   <<< local_rank: 0
2024-08-20 02:31:24,832:INFO:   <<< loose_type: True
2024-08-20 02:31:24,832:INFO:   <<< lr: 0.001
2024-08-20 02:31:24,832:INFO:   <<< lr_decay: 0.9
2024-08-20 02:31:24,832:INFO:   <<< margin: 0.1
2024-08-20 02:31:24,832:INFO:   <<< max_frames: 12
2024-08-20 02:31:24,832:INFO:   <<< max_words: 32
2024-08-20 02:31:24,832:INFO:   <<< n_display: 10
2024-08-20 02:31:24,832:INFO:   <<< n_gpu: 1
2024-08-20 02:31:24,832:INFO:   <<< n_pair: 1
2024-08-20 02:31:24,832:INFO:   <<< negative_weighting: 1
2024-08-20 02:31:24,832:INFO:   <<< num_thread_reader: 8
2024-08-20 02:31:24,832:INFO:   <<< output_dir: outputs/test2/mw0.5-sep1-thresh0.7
2024-08-20 02:31:24,832:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-08-20 02:31:24,833:INFO:   <<< rank: 0
2024-08-20 02:31:24,833:INFO:   <<< resume_model: None
2024-08-20 02:31:24,833:INFO:   <<< sam: False
2024-08-20 02:31:24,833:INFO:   <<< sampled_use_mil: False
2024-08-20 02:31:24,833:INFO:   <<< seed: 42
2024-08-20 02:31:24,833:INFO:   <<< sim_header: seqTransf
2024-08-20 02:31:24,833:INFO:   <<< slice_framepos: 2
2024-08-20 02:31:24,833:INFO:   <<< task_type: retrieval
2024-08-20 02:31:24,833:INFO:   <<< text_num_hidden_layers: 12
2024-08-20 02:31:24,833:INFO:   <<< train_csv: data/MSRVTT//MSRVTT_train.9k.csv
2024-08-20 02:31:24,833:INFO:   <<< train_frame_order: 0
2024-08-20 02:31:24,833:INFO:   <<< use_mil: False
2024-08-20 02:31:24,833:INFO:   <<< val_csv: data/MSRVTT//MSRVTT_JSFUSION_test.csv
2024-08-20 02:31:24,833:INFO:   <<< video_dim: 1024
2024-08-20 02:31:24,833:INFO:   <<< visual_num_hidden_layers: 12
2024-08-20 02:31:24,833:INFO:   <<< warmup_proportion: 0.1
2024-08-20 02:31:24,833:INFO:   <<< world_size: 4
2024-08-20 02:31:24,833:INFO: device: cuda:0 n_gpu: 4
2024-08-20 02:31:24,840:INFO: copy done
2024-08-20 02:31:24,840:INFO: device: cuda:2 n_gpu: 4
2024-08-20 02:31:26,654:INFO: loading archive file /data2/dengrui/projects_opensource/hc-align/modules/cross-base
2024-08-20 02:31:26,655:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-08-20 02:31:26,655:INFO: Weight doesn't exsits. /data2/dengrui/projects_opensource/hc-align/modules/cross-base/cross_pytorch_model.bin
2024-08-20 02:31:26,655:WARNING: 	 embed_dim: 512
2024-08-20 02:31:26,655:WARNING: 	 image_resolution: 224
2024-08-20 02:31:26,655:WARNING: 	 vision_layers: 12
2024-08-20 02:31:26,655:WARNING: 	 vision_width: 768
2024-08-20 02:31:26,655:WARNING: 	 vision_patch_size: 32
2024-08-20 02:31:26,655:WARNING: 	 context_length: 77
2024-08-20 02:31:26,655:WARNING: 	 vocab_size: 49408
2024-08-20 02:31:26,655:WARNING: 	 transformer_width: 512
2024-08-20 02:31:26,655:WARNING: 	 transformer_heads: 8
2024-08-20 02:31:26,655:WARNING: 	 transformer_layers: 12
2024-08-20 02:31:26,655:WARNING: 		 linear_patch: 2d
2024-08-20 02:31:26,656:WARNING: 	 cut_top_layer: 0
2024-08-20 02:31:28,521:WARNING: 	 sim_header: seqTransf
2024-08-20 02:31:28,521:WARNING: Set cross_config.num_hidden_layers: 4.
2024-08-20 02:31:28,784:INFO: --------------------
2024-08-20 02:31:28,784:INFO: Weights of HcAlign not initialized from pretrained model: 
   guided_video_pool.layer_norm1.weight
   guided_video_pool.layer_norm1.bias
   guided_video_pool.layer_norm2.weight
   guided_video_pool.layer_norm2.bias
   guided_text_pool.layer_norm1.weight
   guided_text_pool.layer_norm1.bias
   guided_text_pool.layer_norm2.weight
   guided_text_pool.layer_norm2.bias
   prototype_generator.prototype.weight
   proj_visual.0.weight
   proj_visual.0.bias
   proj_visual.2.weight
   proj_visual.2.bias
   proj_visual.2.running_mean
   proj_visual.2.running_var
   proj_visual.4.weight
   proj_visual.4.bias
   proj_text.0.weight
   proj_text.0.bias
   proj_text.2.weight
   proj_text.2.bias
   proj_text.2.running_mean
   proj_text.2.running_var
   proj_text.4.weight
   proj_text.4.bias
2024-08-20 02:31:28,784:INFO: Weights from pretrained model not used in HcAlign: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-08-20 02:31:31,159:INFO: ***** Running test *****
2024-08-20 02:31:31,159:INFO:   Num examples = 1000
2024-08-20 02:31:31,159:INFO:   Batch size = 48
2024-08-20 02:31:31,159:INFO:   Num steps = 21
2024-08-20 02:31:31,159:INFO: ***** Running val *****
2024-08-20 02:31:31,159:INFO:   Num examples = 1000
2024-08-20 02:31:47,595:INFO: ***** Running training *****
2024-08-20 02:31:47,595:INFO:   Num examples = 180000
2024-08-20 02:31:47,595:INFO:   Batch size = 256
2024-08-20 02:31:47,595:INFO:   Num steps = 3515
2024-08-20 02:32:08,305:INFO: {'sim_loss': 2.48974347114563, 'loss': 2.48974347114563}
2024-08-20 02:32:08,307:INFO: Epoch: 1/5, Step: 1/703, Lr: 0.000000000-0.000002845, Loss: 2.489743, Time/step: 2.068884
2024-08-20 02:32:09,683:INFO: {'sim_loss': 2.3635387420654297, 'loss': 2.3635387420654297}
2024-08-20 02:32:09,685:INFO: Epoch: 1/5, Step: 2/703, Lr: 0.000000001-0.000005690, Loss: 2.363539, Time/step: 0.137830
2024-08-20 02:32:10,994:INFO: {'sim_loss': 2.481393814086914, 'loss': 2.481393814086914}
2024-08-20 02:32:10,997:INFO: Epoch: 1/5, Step: 3/703, Lr: 0.000000001-0.000008535, Loss: 2.481394, Time/step: 0.131178
2024-08-20 02:32:11,799:INFO: {'sim_loss': 2.3734285831451416, 'loss': 2.3734285831451416}
2024-08-20 02:32:11,804:INFO: Epoch: 1/5, Step: 4/703, Lr: 0.000000001-0.000011380, Loss: 2.373429, Time/step: 0.080643
2024-08-20 02:32:16,833:INFO: {'sim_loss': 2.2784671783447266, 'loss': 2.2784671783447266}
2024-08-20 02:32:16,835:INFO: Epoch: 1/5, Step: 10/703, Lr: 0.000000003-0.000028450, Loss: 2.278467, Time/step: 0.503136
2024-08-20 02:32:25,811:INFO: {'sim_loss': 2.0833213329315186, 'loss': 2.0833213329315186}
2024-08-20 02:32:25,813:INFO: Epoch: 1/5, Step: 20/703, Lr: 0.000000006-0.000056899, Loss: 2.083321, Time/step: 0.897758
2024-08-20 02:32:34,476:INFO: {'sim_loss': 2.0166618824005127, 'loss': 2.0166618824005127}
2024-08-20 02:32:34,479:INFO: Epoch: 1/5, Step: 30/703, Lr: 0.000000009-0.000085349, Loss: 2.016662, Time/step: 0.866554
2024-08-20 02:32:44,300:INFO: {'sim_loss': 1.6977968215942383, 'loss': 1.6977968215942383}
2024-08-20 02:32:44,303:INFO: Epoch: 1/5, Step: 40/703, Lr: 0.000000011-0.000113798, Loss: 1.697797, Time/step: 0.982407
2024-08-20 02:32:54,531:INFO: {'sim_loss': 1.793581485748291, 'loss': 1.793581485748291}
2024-08-20 02:32:54,533:INFO: Epoch: 1/5, Step: 50/703, Lr: 0.000000014-0.000142248, Loss: 1.793581, Time/step: 1.023021
2024-08-20 02:33:05,873:INFO: {'sim_loss': 1.5635020732879639, 'loss': 1.5635020732879639}
2024-08-20 02:33:05,875:INFO: Epoch: 1/5, Step: 60/703, Lr: 0.000000017-0.000170697, Loss: 1.563502, Time/step: 1.134117
2024-08-20 02:33:17,156:INFO: {'sim_loss': 1.6803267002105713, 'loss': 1.6803267002105713}
2024-08-20 02:33:17,161:INFO: Epoch: 1/5, Step: 70/703, Lr: 0.000000020-0.000199147, Loss: 1.680327, Time/step: 1.128584
2024-08-20 02:33:28,765:INFO: {'sim_loss': 1.6091986894607544, 'loss': 1.6091986894607544}
2024-08-20 02:33:28,767:INFO: Epoch: 1/5, Step: 80/703, Lr: 0.000000023-0.000227596, Loss: 1.609199, Time/step: 1.160651
2024-08-20 02:33:39,576:INFO: {'sim_loss': 1.5317704677581787, 'loss': 1.5317704677581787}
2024-08-20 02:33:39,579:INFO: Epoch: 1/5, Step: 90/703, Lr: 0.000000026-0.000256046, Loss: 1.531770, Time/step: 1.081097
2024-08-20 02:33:50,213:INFO: {'sim_loss': 1.540876030921936, 'loss': 1.540876030921936}
2024-08-20 02:33:50,215:INFO: Epoch: 1/5, Step: 100/703, Lr: 0.000000028-0.000284495, Loss: 1.540876, Time/step: 1.063608
2024-08-20 02:34:01,012:INFO: {'sim_loss': 1.5954616069793701, 'loss': 1.5954616069793701}
2024-08-20 02:34:01,014:INFO: Epoch: 1/5, Step: 110/703, Lr: 0.000000031-0.000312945, Loss: 1.595462, Time/step: 1.079945
2024-08-20 02:34:12,062:INFO: {'sim_loss': 1.3597971200942993, 'loss': 1.3597971200942993}
2024-08-20 02:34:12,064:INFO: Epoch: 1/5, Step: 120/703, Lr: 0.000000034-0.000341394, Loss: 1.359797, Time/step: 1.104913
2024-08-20 02:34:22,195:INFO: {'sim_loss': 1.2272354364395142, 'loss': 1.2272354364395142}
2024-08-20 02:34:22,197:INFO: Epoch: 1/5, Step: 130/703, Lr: 0.000000037-0.000369844, Loss: 1.227235, Time/step: 1.013339
2024-08-20 02:34:33,226:INFO: {'sim_loss': 1.6243230104446411, 'loss': 1.6243230104446411}
2024-08-20 02:34:33,228:INFO: Epoch: 1/5, Step: 140/703, Lr: 0.000000040-0.000398293, Loss: 1.624323, Time/step: 1.103048
2024-08-20 02:34:44,033:INFO: {'sim_loss': 1.292027235031128, 'loss': 1.292027235031128}
2024-08-20 02:34:44,035:INFO: Epoch: 1/5, Step: 150/703, Lr: 0.000000043-0.000426743, Loss: 1.292027, Time/step: 1.080687
2024-08-20 02:34:54,639:INFO: {'sim_loss': 1.4050228595733643, 'loss': 1.4050228595733643}
2024-08-20 02:34:54,641:INFO: Epoch: 1/5, Step: 160/703, Lr: 0.000000046-0.000455192, Loss: 1.405023, Time/step: 1.060628
2024-08-20 02:35:05,795:INFO: {'sim_loss': 1.4805856943130493, 'loss': 1.4805856943130493}
2024-08-20 02:35:05,797:INFO: Epoch: 1/5, Step: 170/703, Lr: 0.000000048-0.000483642, Loss: 1.480586, Time/step: 1.115504
2024-08-20 02:35:16,477:INFO: {'sim_loss': 1.3625552654266357, 'loss': 1.3625552654266357}
2024-08-20 02:35:16,479:INFO: Epoch: 1/5, Step: 180/703, Lr: 0.000000051-0.000512091, Loss: 1.362555, Time/step: 1.068254
2024-08-20 02:35:26,929:INFO: {'sim_loss': 1.3728818893432617, 'loss': 1.3728818893432617}
2024-08-20 02:35:26,931:INFO: Epoch: 1/5, Step: 190/703, Lr: 0.000000054-0.000540541, Loss: 1.372882, Time/step: 1.045154
2024-08-20 02:35:39,414:INFO: {'sim_loss': 1.2982869148254395, 'loss': 1.2982869148254395}
2024-08-20 02:35:39,417:INFO: Epoch: 1/5, Step: 200/703, Lr: 0.000000057-0.000568990, Loss: 1.298287, Time/step: 1.248572
2024-08-20 02:35:49,189:INFO: {'sim_loss': 1.2948451042175293, 'loss': 1.2948451042175293}
2024-08-20 02:35:49,191:INFO: Epoch: 1/5, Step: 210/703, Lr: 0.000000060-0.000597440, Loss: 1.294845, Time/step: 0.977404
2024-08-20 02:35:59,898:INFO: {'sim_loss': 1.2040600776672363, 'loss': 1.2040600776672363}
2024-08-20 02:35:59,900:INFO: Epoch: 1/5, Step: 220/703, Lr: 0.000000063-0.000625889, Loss: 1.204060, Time/step: 1.070860
2024-08-20 02:36:10,185:INFO: {'sim_loss': 1.1494368314743042, 'loss': 1.1494368314743042}
2024-08-20 02:36:10,187:INFO: Epoch: 1/5, Step: 230/703, Lr: 0.000000065-0.000654339, Loss: 1.149437, Time/step: 1.028696
2024-08-20 02:36:21,330:INFO: {'sim_loss': 1.323821783065796, 'loss': 1.323821783065796}
2024-08-20 02:36:21,332:INFO: Epoch: 1/5, Step: 240/703, Lr: 0.000000068-0.000682788, Loss: 1.323822, Time/step: 1.114484
2024-08-20 02:36:31,599:INFO: {'sim_loss': 1.1949913501739502, 'loss': 1.1949913501739502}
2024-08-20 02:36:31,601:INFO: Epoch: 1/5, Step: 250/703, Lr: 0.000000071-0.000711238, Loss: 1.194991, Time/step: 1.026879
2024-08-20 02:36:41,648:INFO: {'sim_loss': 1.2449935674667358, 'loss': 1.2449935674667358}
2024-08-20 02:36:41,651:INFO: Epoch: 1/5, Step: 260/703, Lr: 0.000000074-0.000739687, Loss: 1.244994, Time/step: 1.004929
2024-08-20 02:36:52,304:INFO: {'sim_loss': 1.058622121810913, 'loss': 1.058622121810913}
2024-08-20 02:36:52,307:INFO: Epoch: 1/5, Step: 270/703, Lr: 0.000000077-0.000768137, Loss: 1.058622, Time/step: 1.065565
2024-08-20 02:37:03,582:INFO: {'sim_loss': 1.3541898727416992, 'loss': 1.3541898727416992}
2024-08-20 02:37:03,584:INFO: Epoch: 1/5, Step: 280/703, Lr: 0.000000080-0.000796586, Loss: 1.354190, Time/step: 1.127736
2024-08-20 02:37:13,830:INFO: {'sim_loss': 1.3666478395462036, 'loss': 1.3666478395462036}
2024-08-20 02:37:13,832:INFO: Epoch: 1/5, Step: 290/703, Lr: 0.000000083-0.000825036, Loss: 1.366648, Time/step: 1.024787
2024-08-20 02:37:23,775:INFO: {'sim_loss': 1.1032540798187256, 'loss': 1.1032540798187256}
2024-08-20 02:37:23,779:INFO: Epoch: 1/5, Step: 300/703, Lr: 0.000000085-0.000853485, Loss: 1.103254, Time/step: 0.994638
2024-08-20 02:37:34,932:INFO: {'sim_loss': 1.2017180919647217, 'loss': 1.2017180919647217}
2024-08-20 02:37:34,934:INFO: Epoch: 1/5, Step: 310/703, Lr: 0.000000088-0.000881935, Loss: 1.201718, Time/step: 1.115499
2024-08-20 02:37:45,540:INFO: {'sim_loss': 1.1693999767303467, 'loss': 1.1693999767303467}
2024-08-20 02:37:45,543:INFO: Epoch: 1/5, Step: 320/703, Lr: 0.000000091-0.000910384, Loss: 1.169400, Time/step: 1.060856
2024-08-20 02:37:56,373:INFO: {'sim_loss': 1.314852237701416, 'loss': 1.314852237701416}
2024-08-20 02:37:56,375:INFO: Epoch: 1/5, Step: 330/703, Lr: 0.000000094-0.000938834, Loss: 1.314852, Time/step: 1.083225
2024-08-20 02:38:07,696:INFO: {'sim_loss': 1.2722015380859375, 'loss': 1.2722015380859375}
2024-08-20 02:38:07,698:INFO: Epoch: 1/5, Step: 340/703, Lr: 0.000000097-0.000967283, Loss: 1.272202, Time/step: 1.132292
2024-08-20 02:38:18,429:INFO: {'sim_loss': 1.3439838886260986, 'loss': 1.3439838886260986}
2024-08-20 02:38:18,431:INFO: Epoch: 1/5, Step: 350/703, Lr: 0.000000100-0.000995733, Loss: 1.343984, Time/step: 1.073302
2024-08-20 02:38:28,793:INFO: {'sim_loss': 1.2505817413330078, 'loss': 1.2505817413330078}
2024-08-20 02:38:28,795:INFO: Epoch: 1/5, Step: 360/703, Lr: 0.000000097-0.000974341, Loss: 1.250582, Time/step: 1.036409
2024-08-20 02:38:39,268:INFO: {'sim_loss': 1.1107643842697144, 'loss': 1.1107643842697144}
2024-08-20 02:38:39,270:INFO: Epoch: 1/5, Step: 370/703, Lr: 0.000000097-0.000972909, Loss: 1.110764, Time/step: 1.047424
2024-08-20 02:38:51,046:INFO: {'sim_loss': 1.144309401512146, 'loss': 1.144309401512146}
2024-08-20 02:38:51,049:INFO: Epoch: 1/5, Step: 380/703, Lr: 0.000000097-0.000971439, Loss: 1.144309, Time/step: 1.177913
2024-08-20 02:39:01,264:INFO: {'sim_loss': 0.9576795697212219, 'loss': 0.9576795697212219}
2024-08-20 02:39:01,266:INFO: Epoch: 1/5, Step: 390/703, Lr: 0.000000097-0.000969931, Loss: 0.957680, Time/step: 1.021691
2024-08-20 02:39:10,846:INFO: {'sim_loss': 1.0699520111083984, 'loss': 1.0699520111083984}
2024-08-20 02:39:10,848:INFO: Epoch: 1/5, Step: 400/703, Lr: 0.000000097-0.000968386, Loss: 1.069952, Time/step: 0.958211
2024-08-20 02:39:20,385:INFO: {'sim_loss': 1.2516916990280151, 'loss': 1.2516916990280151}
2024-08-20 02:39:20,387:INFO: Epoch: 1/5, Step: 410/703, Lr: 0.000000097-0.000966804, Loss: 1.251692, Time/step: 0.953832
2024-08-20 02:39:31,728:INFO: {'sim_loss': 1.2984511852264404, 'loss': 1.2984511852264404}
2024-08-20 02:39:31,731:INFO: Epoch: 1/5, Step: 420/703, Lr: 0.000000097-0.000965184, Loss: 1.298451, Time/step: 1.134369
2024-08-20 02:39:40,873:INFO: {'sim_loss': 1.0149877071380615, 'loss': 1.0149877071380615}
2024-08-20 02:39:40,875:INFO: Epoch: 1/5, Step: 430/703, Lr: 0.000000096-0.000963527, Loss: 1.014988, Time/step: 0.914444
2024-08-20 02:39:50,794:INFO: {'sim_loss': 1.2249653339385986, 'loss': 1.2249653339385986}
2024-08-20 02:39:50,796:INFO: Epoch: 1/5, Step: 440/703, Lr: 0.000000096-0.000961833, Loss: 1.224965, Time/step: 0.992094
2024-08-20 02:40:01,834:INFO: {'sim_loss': 1.3294758796691895, 'loss': 1.3294758796691895}
2024-08-20 02:40:01,836:INFO: Epoch: 1/5, Step: 450/703, Lr: 0.000000096-0.000960102, Loss: 1.329476, Time/step: 1.103953
2024-08-20 02:40:12,760:INFO: {'sim_loss': 1.326580286026001, 'loss': 1.326580286026001}
2024-08-20 02:40:12,762:INFO: Epoch: 1/5, Step: 460/703, Lr: 0.000000096-0.000958334, Loss: 1.326580, Time/step: 1.092569
2024-08-20 02:40:24,073:INFO: {'sim_loss': 1.2082655429840088, 'loss': 1.2082655429840088}
2024-08-20 02:40:24,075:INFO: Epoch: 1/5, Step: 470/703, Lr: 0.000000096-0.000956530, Loss: 1.208266, Time/step: 1.131308
2024-08-20 02:40:33,787:INFO: {'sim_loss': 1.131356954574585, 'loss': 1.131356954574585}
2024-08-20 02:40:33,789:INFO: Epoch: 1/5, Step: 480/703, Lr: 0.000000095-0.000954689, Loss: 1.131357, Time/step: 0.971346
2024-08-20 02:40:43,778:INFO: {'sim_loss': 1.213698387145996, 'loss': 1.213698387145996}
2024-08-20 02:40:43,780:INFO: Epoch: 1/5, Step: 490/703, Lr: 0.000000095-0.000952812, Loss: 1.213698, Time/step: 0.999097
2024-08-20 02:40:54,907:INFO: {'sim_loss': 1.2558746337890625, 'loss': 1.2558746337890625}
2024-08-20 02:40:54,911:INFO: Epoch: 1/5, Step: 500/703, Lr: 0.000000095-0.000950899, Loss: 1.255875, Time/step: 1.113042
2024-08-20 02:41:05,757:INFO: {'sim_loss': 1.2419005632400513, 'loss': 1.2419005632400513}
2024-08-20 02:41:05,759:INFO: Epoch: 1/5, Step: 510/703, Lr: 0.000000095-0.000948950, Loss: 1.241901, Time/step: 1.084813
2024-08-20 02:41:16,154:INFO: {'sim_loss': 1.0510375499725342, 'loss': 1.0510375499725342}
2024-08-20 02:41:16,156:INFO: Epoch: 1/5, Step: 520/703, Lr: 0.000000095-0.000946965, Loss: 1.051038, Time/step: 1.039703
2024-08-20 02:41:26,473:INFO: {'sim_loss': 1.1201930046081543, 'loss': 1.1201930046081543}
2024-08-20 02:41:26,475:INFO: Epoch: 1/5, Step: 530/703, Lr: 0.000000094-0.000944944, Loss: 1.120193, Time/step: 1.031885
2024-08-20 02:41:37,753:INFO: {'sim_loss': 1.1227037906646729, 'loss': 1.1227037906646729}
2024-08-20 02:41:37,755:INFO: Epoch: 1/5, Step: 540/703, Lr: 0.000000094-0.000942888, Loss: 1.122704, Time/step: 1.127949
2024-08-20 02:41:47,752:INFO: {'sim_loss': 1.0818915367126465, 'loss': 1.0818915367126465}
2024-08-20 02:41:47,755:INFO: Epoch: 1/5, Step: 550/703, Lr: 0.000000094-0.000940796, Loss: 1.081892, Time/step: 0.999946
2024-08-20 02:41:58,060:INFO: {'sim_loss': 1.0266575813293457, 'loss': 1.0266575813293457}
2024-08-20 02:41:58,062:INFO: Epoch: 1/5, Step: 560/703, Lr: 0.000000094-0.000938669, Loss: 1.026658, Time/step: 1.030761
2024-08-20 02:42:08,242:INFO: {'sim_loss': 1.0086250305175781, 'loss': 1.0086250305175781}
2024-08-20 02:42:08,244:INFO: Epoch: 1/5, Step: 570/703, Lr: 0.000000094-0.000936507, Loss: 1.008625, Time/step: 1.018185
2024-08-20 02:42:19,073:INFO: {'sim_loss': 1.2208881378173828, 'loss': 1.2208881378173828}
2024-08-20 02:42:19,075:INFO: Epoch: 1/5, Step: 580/703, Lr: 0.000000093-0.000934310, Loss: 1.220888, Time/step: 1.083090
2024-08-20 02:42:29,032:INFO: {'sim_loss': 1.0931587219238281, 'loss': 1.0931587219238281}
2024-08-20 02:42:29,034:INFO: Epoch: 1/5, Step: 590/703, Lr: 0.000000093-0.000932079, Loss: 1.093159, Time/step: 0.995898
2024-08-20 02:42:38,891:INFO: {'sim_loss': 1.0104728937149048, 'loss': 1.0104728937149048}
2024-08-20 02:42:38,893:INFO: Epoch: 1/5, Step: 600/703, Lr: 0.000000093-0.000929813, Loss: 1.010473, Time/step: 0.985869
2024-08-20 02:42:49,217:INFO: {'sim_loss': 1.4682036638259888, 'loss': 1.4682036638259888}
2024-08-20 02:42:49,219:INFO: Epoch: 1/5, Step: 610/703, Lr: 0.000000093-0.000927512, Loss: 1.468204, Time/step: 1.032478
2024-08-20 02:43:00,511:INFO: {'sim_loss': 1.0010281801223755, 'loss': 1.0010281801223755}
2024-08-20 02:43:00,514:INFO: Epoch: 1/5, Step: 620/703, Lr: 0.000000093-0.000925178, Loss: 1.001028, Time/step: 1.129544
2024-08-20 02:43:10,602:INFO: {'sim_loss': 1.0615644454956055, 'loss': 1.0615644454956055}
2024-08-20 02:43:10,604:INFO: Epoch: 1/5, Step: 630/703, Lr: 0.000000092-0.000922809, Loss: 1.061564, Time/step: 1.008958
2024-08-20 02:43:20,815:INFO: {'sim_loss': 1.0047210454940796, 'loss': 1.0047210454940796}
2024-08-20 02:43:20,817:INFO: Epoch: 1/5, Step: 640/703, Lr: 0.000000092-0.000920407, Loss: 1.004721, Time/step: 1.021316
2024-08-20 02:43:30,857:INFO: {'sim_loss': 1.0636507272720337, 'loss': 1.0636507272720337}
2024-08-20 02:43:30,859:INFO: Epoch: 1/5, Step: 650/703, Lr: 0.000000092-0.000917971, Loss: 1.063651, Time/step: 1.004154
2024-08-20 02:43:41,700:INFO: {'sim_loss': 1.1044718027114868, 'loss': 1.1044718027114868}
2024-08-20 02:43:41,701:INFO: Epoch: 1/5, Step: 660/703, Lr: 0.000000092-0.000915502, Loss: 1.104472, Time/step: 1.084232
2024-08-20 02:43:52,022:INFO: {'sim_loss': 1.009354591369629, 'loss': 1.009354591369629}
2024-08-20 02:43:52,024:INFO: Epoch: 1/5, Step: 670/703, Lr: 0.000000091-0.000912999, Loss: 1.009355, Time/step: 1.032213
2024-08-20 02:44:02,357:INFO: {'sim_loss': 1.085003137588501, 'loss': 1.085003137588501}
2024-08-20 02:44:02,359:INFO: Epoch: 1/5, Step: 680/703, Lr: 0.000000091-0.000910464, Loss: 1.085003, Time/step: 1.033526
2024-08-20 02:44:13,228:INFO: {'sim_loss': 1.1761424541473389, 'loss': 1.1761424541473389}
2024-08-20 02:44:13,230:INFO: Epoch: 1/5, Step: 690/703, Lr: 0.000000091-0.000907896, Loss: 1.176142, Time/step: 1.087051
2024-08-20 02:44:21,767:INFO: {'sim_loss': 0.937995433807373, 'loss': 0.937995433807373}
2024-08-20 02:44:21,769:INFO: Epoch: 1/5, Step: 700/703, Lr: 0.000000091-0.000905295, Loss: 0.937995, Time/step: 0.853887
2024-08-20 02:44:24,576:INFO: Eval on val dataset
2024-08-20 02:44:24,576:INFO: Epoch 1/5 Finished, Train Loss: 1.304477
2024-08-20 02:44:24,577:INFO: Eval on val dataset
2024-08-20 02:44:35,028:INFO: sim matrix size: 1000, 1000
2024-08-20 02:44:35,130:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 02:44:35,130:INFO: 	>>>[703][constrast] Text-to-Video  R@1: 45.7 - R@5: 73.9 - R@10: 81.8 - Median R: 2.0 - Mean R: 13.7
2024-08-20 02:44:35,130:INFO: 	>>> [703][constrast] V2T$R@1: 45.3 - V2T$R@5: 74.0 - V2T$R@10: 82.8 - V2T$Median R: 2.0 - V2T$Mean R: 9.8
2024-08-20 02:44:35,624:INFO: The best model is: outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth, the R1 is: 45.7000
2024-08-20 02:44:35,788:INFO: Start generating the context prototype set.
2024-08-20 02:44:35,788:INFO: Start generating the context prototype set.
2024-08-20 02:44:35,789:INFO: Start generating the context prototype set.
2024-08-20 02:44:35,790:INFO: Start generating the context prototype set.
2024-08-20 02:44:54,998:INFO: Initializion of the memory banks done.
2024-08-20 02:45:03,355:INFO: Initializion of the memory banks done.
2024-08-20 02:45:03,622:INFO: Initializion of the memory banks done.
2024-08-20 02:45:03,646:INFO: Initializion of the memory banks done.
2024-08-20 02:45:03,700:INFO: Start to do clustering...
2024-08-20 02:45:03,700:INFO: Start to do clustering...
2024-08-20 02:45:03,700:INFO: Start to do clustering...
2024-08-20 02:45:03,701:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6375654339790344
2024-08-20 02:45:03,701:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6375654339790344
2024-08-20 02:45:03,701:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6375654339790344
2024-08-20 02:45:03,701:INFO: Start to do clustering...
2024-08-20 02:45:03,703:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6375654339790344
2024-08-20 02:45:03,709:INFO: [rank=0] centroids: 0.6344669461250305
2024-08-20 02:45:03,710:INFO: [rank=1] centroids: 0.6344669461250305
2024-08-20 02:45:03,912:INFO: [rank=0] centroids: 0.6510449647903442
2024-08-20 02:45:03,912:INFO: [rank=1] centroids: 0.6510449647903442
2024-08-20 02:45:04,111:INFO: [rank=1] centroids: 0.6498053669929504
2024-08-20 02:45:04,111:INFO: [rank=0] centroids: 0.6498053669929504
2024-08-20 02:45:04,307:INFO: [rank=1] centroids: 0.6499025225639343
2024-08-20 02:45:04,307:INFO: [rank=0] centroids: 0.6499025225639343
2024-08-20 02:45:04,503:INFO: [rank=1] centroids: 0.6511846780776978
2024-08-20 02:45:04,503:INFO: [rank=0] centroids: 0.6511846780776978
2024-08-20 02:45:04,698:INFO: [rank=1] centroids: 0.6525347828865051
2024-08-20 02:45:04,698:INFO: [rank=0] centroids: 0.6525347828865051
2024-08-20 02:45:04,890:INFO: [rank=1] centroids: 0.6532468795776367
2024-08-20 02:45:04,890:INFO: [rank=0] centroids: 0.6532468795776367
2024-08-20 02:45:05,086:INFO: [rank=1] centroids: 0.6532530784606934
2024-08-20 02:45:05,086:INFO: [rank=0] centroids: 0.6532530784606934
2024-08-20 02:45:05,279:INFO: [rank=0] centroids: 0.6529266834259033
2024-08-20 02:45:05,279:INFO: [rank=1] centroids: 0.6529266834259033
2024-08-20 02:45:05,476:INFO: [rank=1] centroids: 0.6531499028205872
2024-08-20 02:45:05,476:INFO: [rank=0] centroids: 0.6531499028205872
2024-08-20 02:45:05,671:INFO: [rank=1] centroids: 0.653309166431427
2024-08-20 02:45:05,671:INFO: [rank=0] centroids: 0.653309166431427
2024-08-20 02:45:05,731:INFO: Clustering done.
2024-08-20 02:45:05,731:INFO: Clustering done.
2024-08-20 02:45:05,731:INFO: Clustering done.
2024-08-20 02:45:05,732:INFO: Context prototype set generated.
2024-08-20 02:45:05,732:INFO: Context prototype set generated.
2024-08-20 02:45:05,732:INFO: Context prototype set generated.
2024-08-20 02:45:05,735:INFO: Clustering done.
2024-08-20 02:45:05,736:INFO: Context prototype set generated.
2024-08-20 02:45:15,455:INFO: {'sim_loss': 1.0281682014465332, 'siou_loss': 0.6240613460540771, 'loss': 1.3401988744735718}
2024-08-20 02:45:15,457:INFO: Epoch: 2/5, Step: 1/703, Lr: 0.000000090-0.000002845-0.000904246, Loss: 1.340199, Time/step: 3.966885
2024-08-20 02:45:16,543:INFO: {'sim_loss': 0.8512884378433228, 'siou_loss': 0.6232244968414307, 'loss': 1.162900686264038}
2024-08-20 02:45:16,551:INFO: Epoch: 2/5, Step: 2/703, Lr: 0.000000090-0.000005690-0.000903983, Loss: 1.162901, Time/step: 0.109039
2024-08-20 02:45:17,653:INFO: {'sim_loss': 1.048830509185791, 'siou_loss': 0.6237152218818665, 'loss': 1.3606880903244019}
2024-08-20 02:45:17,656:INFO: Epoch: 2/5, Step: 3/703, Lr: 0.000000090-0.000008535-0.000903719, Loss: 1.360688, Time/step: 0.110440
2024-08-20 02:45:18,701:INFO: {'sim_loss': 0.9088879823684692, 'siou_loss': 0.6183121800422668, 'loss': 1.2180440425872803}
2024-08-20 02:45:18,703:INFO: Epoch: 2/5, Step: 4/703, Lr: 0.000000090-0.000011380-0.000903455, Loss: 1.218044, Time/step: 0.104756
2024-08-20 02:45:21,945:INFO: {'sim_loss': 0.8240622878074646, 'siou_loss': 0.6185171008110046, 'loss': 1.1333208084106445}
2024-08-20 02:45:21,948:INFO: Epoch: 2/5, Step: 7/703, Lr: 0.000000090-0.000019915-0.000902662, Loss: 1.133321, Time/step: 0.324496
2024-08-20 02:45:33,135:INFO: {'sim_loss': 0.9542506337165833, 'siou_loss': 0.5947865843772888, 'loss': 1.2516438961029053}
2024-08-20 02:45:33,138:INFO: Epoch: 2/5, Step: 17/703, Lr: 0.000000090-0.000048364-0.000899997, Loss: 1.251644, Time/step: 1.118911
2024-08-20 02:45:44,074:INFO: {'sim_loss': 0.8783677816390991, 'siou_loss': 0.5370491147041321, 'loss': 1.1468923091888428}
2024-08-20 02:45:44,076:INFO: Epoch: 2/5, Step: 27/703, Lr: 0.000000090-0.000076814-0.000897299, Loss: 1.146892, Time/step: 1.093854
2024-08-20 02:45:54,947:INFO: {'sim_loss': 0.8911778926849365, 'siou_loss': 0.45435282588005066, 'loss': 1.118354320526123}
2024-08-20 02:45:54,949:INFO: Epoch: 2/5, Step: 37/703, Lr: 0.000000089-0.000105263-0.000894570, Loss: 1.118354, Time/step: 1.087265
2024-08-20 02:46:05,891:INFO: {'sim_loss': 1.1137938499450684, 'siou_loss': 0.36162272095680237, 'loss': 1.2946052551269531}
2024-08-20 02:46:05,893:INFO: Epoch: 2/5, Step: 47/703, Lr: 0.000000089-0.000133713-0.000891810, Loss: 1.294605, Time/step: 1.094404
2024-08-20 02:46:17,393:INFO: {'sim_loss': 1.1219158172607422, 'siou_loss': 0.2721520662307739, 'loss': 1.2579917907714844}
2024-08-20 02:46:17,395:INFO: Epoch: 2/5, Step: 57/703, Lr: 0.000000089-0.000162162-0.000889018, Loss: 1.257992, Time/step: 1.150186
2024-08-20 02:46:28,600:INFO: {'sim_loss': 0.9792113304138184, 'siou_loss': 0.21157652139663696, 'loss': 1.0849995613098145}
2024-08-20 02:46:28,603:INFO: Epoch: 2/5, Step: 67/703, Lr: 0.000000089-0.000190612-0.000886195, Loss: 1.085000, Time/step: 1.120712
2024-08-20 02:46:39,344:INFO: {'sim_loss': 0.8602259159088135, 'siou_loss': 0.17012140154838562, 'loss': 0.9452866315841675}
2024-08-20 02:46:39,347:INFO: Epoch: 2/5, Step: 77/703, Lr: 0.000000088-0.000219061-0.000883341, Loss: 0.945287, Time/step: 1.074381
2024-08-20 02:46:50,055:INFO: {'sim_loss': 1.0140681266784668, 'siou_loss': 0.14781871438026428, 'loss': 1.0879775285720825}
2024-08-20 02:46:50,057:INFO: Epoch: 2/5, Step: 87/703, Lr: 0.000000088-0.000247511-0.000880457, Loss: 1.087978, Time/step: 1.071037
2024-08-20 02:47:00,826:INFO: {'sim_loss': 0.8865491151809692, 'siou_loss': 0.13970860838890076, 'loss': 0.9564034342765808}
2024-08-20 02:47:00,828:INFO: Epoch: 2/5, Step: 97/703, Lr: 0.000000088-0.000275960-0.000877542, Loss: 0.956403, Time/step: 1.077078
2024-08-20 02:47:11,727:INFO: {'sim_loss': 0.9763679504394531, 'siou_loss': 0.13054713606834412, 'loss': 1.0416414737701416}
2024-08-20 02:47:11,730:INFO: Epoch: 2/5, Step: 107/703, Lr: 0.000000087-0.000304410-0.000874597, Loss: 1.041641, Time/step: 1.090163
2024-08-20 02:47:22,609:INFO: {'sim_loss': 1.0590767860412598, 'siou_loss': 0.12443014979362488, 'loss': 1.1212918758392334}
2024-08-20 02:47:22,611:INFO: Epoch: 2/5, Step: 117/703, Lr: 0.000000087-0.000332859-0.000871622, Loss: 1.121292, Time/step: 1.088102
2024-08-20 02:47:33,340:INFO: {'sim_loss': 0.992263913154602, 'siou_loss': 0.11827400326728821, 'loss': 1.051400899887085}
2024-08-20 02:47:33,342:INFO: Epoch: 2/5, Step: 127/703, Lr: 0.000000087-0.000361309-0.000868618, Loss: 1.051401, Time/step: 1.073055
2024-08-20 02:47:44,289:INFO: {'sim_loss': 1.087005853652954, 'siou_loss': 0.11939844489097595, 'loss': 1.1467050313949585}
2024-08-20 02:47:44,291:INFO: Epoch: 2/5, Step: 137/703, Lr: 0.000000087-0.000389758-0.000865584, Loss: 1.146705, Time/step: 1.094957
2024-08-20 02:47:55,086:INFO: {'sim_loss': 0.9919525384902954, 'siou_loss': 0.11762216687202454, 'loss': 1.0507636070251465}
2024-08-20 02:47:55,088:INFO: Epoch: 2/5, Step: 147/703, Lr: 0.000000086-0.000418208-0.000862521, Loss: 1.050764, Time/step: 1.079614
2024-08-20 02:48:06,024:INFO: {'sim_loss': 0.8783865571022034, 'siou_loss': 0.1139369010925293, 'loss': 0.935355007648468}
2024-08-20 02:48:06,026:INFO: Epoch: 2/5, Step: 157/703, Lr: 0.000000086-0.000446657-0.000859428, Loss: 0.935355, Time/step: 1.093790
2024-08-20 02:48:16,858:INFO: {'sim_loss': 0.9051518440246582, 'siou_loss': 0.1133723258972168, 'loss': 0.9618380069732666}
2024-08-20 02:48:16,860:INFO: Epoch: 2/5, Step: 167/703, Lr: 0.000000086-0.000475107-0.000856308, Loss: 0.961838, Time/step: 1.083392
2024-08-20 02:48:27,846:INFO: {'sim_loss': 1.0579581260681152, 'siou_loss': 0.11440232396125793, 'loss': 1.115159273147583}
2024-08-20 02:48:27,848:INFO: Epoch: 2/5, Step: 177/703, Lr: 0.000000085-0.000503556-0.000853158, Loss: 1.115159, Time/step: 1.098827
2024-08-20 02:48:38,621:INFO: {'sim_loss': 0.8243272304534912, 'siou_loss': 0.11319735646247864, 'loss': 0.8809258937835693}
2024-08-20 02:48:38,624:INFO: Epoch: 2/5, Step: 187/703, Lr: 0.000000085-0.000532006-0.000849981, Loss: 0.880926, Time/step: 1.077507
2024-08-20 02:48:49,546:INFO: {'sim_loss': 1.0146479606628418, 'siou_loss': 0.11386185884475708, 'loss': 1.071578860282898}
2024-08-20 02:48:49,549:INFO: Epoch: 2/5, Step: 197/703, Lr: 0.000000085-0.000560455-0.000846775, Loss: 1.071579, Time/step: 1.092475
2024-08-20 02:49:00,332:INFO: {'sim_loss': 1.0770964622497559, 'siou_loss': 0.10786449909210205, 'loss': 1.131028652191162}
2024-08-20 02:49:00,334:INFO: Epoch: 2/5, Step: 207/703, Lr: 0.000000084-0.000588905-0.000843542, Loss: 1.131029, Time/step: 1.078526
2024-08-20 02:49:11,354:INFO: {'sim_loss': 0.8958150148391724, 'siou_loss': 0.10433468222618103, 'loss': 0.9479823708534241}
2024-08-20 02:49:11,357:INFO: Epoch: 2/5, Step: 217/703, Lr: 0.000000084-0.000617354-0.000840281, Loss: 0.947982, Time/step: 1.102279
2024-08-20 02:49:22,294:INFO: {'sim_loss': 0.8535246849060059, 'siou_loss': 0.10475128889083862, 'loss': 0.9059003591537476}
2024-08-20 02:49:22,296:INFO: Epoch: 2/5, Step: 227/703, Lr: 0.000000084-0.000645804-0.000836993, Loss: 0.905900, Time/step: 1.093894
2024-08-20 02:49:33,147:INFO: {'sim_loss': 0.8581556081771851, 'siou_loss': 0.1014619767665863, 'loss': 0.9088866114616394}
2024-08-20 02:49:33,149:INFO: Epoch: 2/5, Step: 237/703, Lr: 0.000000083-0.000674253-0.000833679, Loss: 0.908887, Time/step: 1.085316
2024-08-20 02:49:44,053:INFO: {'sim_loss': 1.0634174346923828, 'siou_loss': 0.1076461672782898, 'loss': 1.11724054813385}
2024-08-20 02:49:44,055:INFO: Epoch: 2/5, Step: 247/703, Lr: 0.000000083-0.000702703-0.000830337, Loss: 1.117241, Time/step: 1.090575
2024-08-20 02:49:54,910:INFO: {'sim_loss': 0.9736149907112122, 'siou_loss': 0.10489827394485474, 'loss': 1.026064157485962}
2024-08-20 02:49:54,913:INFO: Epoch: 2/5, Step: 257/703, Lr: 0.000000083-0.000731152-0.000826970, Loss: 1.026064, Time/step: 1.085755
2024-08-20 02:50:05,782:INFO: {'sim_loss': 0.9728425741195679, 'siou_loss': 0.10564455389976501, 'loss': 1.0256648063659668}
2024-08-20 02:50:05,785:INFO: Epoch: 2/5, Step: 267/703, Lr: 0.000000082-0.000759602-0.000823576, Loss: 1.025665, Time/step: 1.087208
2024-08-20 02:50:16,727:INFO: {'sim_loss': 0.8378485441207886, 'siou_loss': 0.10250985622406006, 'loss': 0.8891034722328186}
2024-08-20 02:50:16,730:INFO: Epoch: 2/5, Step: 277/703, Lr: 0.000000082-0.000788051-0.000820156, Loss: 0.889103, Time/step: 1.094430
2024-08-20 02:50:27,709:INFO: {'sim_loss': 0.910275936126709, 'siou_loss': 0.1044493019580841, 'loss': 0.9625005722045898}
2024-08-20 02:50:27,712:INFO: Epoch: 2/5, Step: 287/703, Lr: 0.000000082-0.000816501-0.000816711, Loss: 0.962501, Time/step: 1.098170
2024-08-20 02:50:38,670:INFO: {'sim_loss': 1.0509755611419678, 'siou_loss': 0.10144758224487305, 'loss': 1.1016993522644043}
2024-08-20 02:50:38,672:INFO: Epoch: 2/5, Step: 297/703, Lr: 0.000000081-0.000813240-0.000844950, Loss: 1.101699, Time/step: 1.096049
2024-08-20 02:50:49,797:INFO: {'sim_loss': 0.9152621626853943, 'siou_loss': 0.10273811221122742, 'loss': 0.9666312336921692}
2024-08-20 02:50:49,799:INFO: Epoch: 2/5, Step: 307/703, Lr: 0.000000081-0.000809744-0.000873400, Loss: 0.966631, Time/step: 1.112702
2024-08-20 02:51:00,522:INFO: {'sim_loss': 0.7917352914810181, 'siou_loss': 0.10545232892036438, 'loss': 0.8444614410400391}
2024-08-20 02:51:00,525:INFO: Epoch: 2/5, Step: 317/703, Lr: 0.000000081-0.000806224-0.000901849, Loss: 0.844461, Time/step: 1.072513
2024-08-20 02:51:11,512:INFO: {'sim_loss': 0.9522003531455994, 'siou_loss': 0.10352110862731934, 'loss': 1.0039608478546143}
2024-08-20 02:51:11,514:INFO: Epoch: 2/5, Step: 327/703, Lr: 0.000000080-0.000802679-0.000930299, Loss: 1.003961, Time/step: 1.098917
2024-08-20 02:51:22,445:INFO: {'sim_loss': 0.782373309135437, 'siou_loss': 0.1020207405090332, 'loss': 0.8333836793899536}
2024-08-20 02:51:22,447:INFO: Epoch: 2/5, Step: 337/703, Lr: 0.000000080-0.000799110-0.000958748, Loss: 0.833384, Time/step: 1.093256
2024-08-20 02:51:33,341:INFO: {'sim_loss': 0.9931105375289917, 'siou_loss': 0.10444658994674683, 'loss': 1.0453338623046875}
2024-08-20 02:51:33,343:INFO: Epoch: 2/5, Step: 347/703, Lr: 0.000000080-0.000795517-0.000987198, Loss: 1.045334, Time/step: 1.089630
2024-08-20 02:51:44,129:INFO: {'sim_loss': 0.8652046322822571, 'siou_loss': 0.09703600406646729, 'loss': 0.9137226343154907}
2024-08-20 02:51:44,132:INFO: Epoch: 2/5, Step: 357/703, Lr: 0.000000079-0.000791901-0.000974763, Loss: 0.913723, Time/step: 1.078851
2024-08-20 02:51:55,037:INFO: {'sim_loss': 0.7912596464157104, 'siou_loss': 0.1002683937549591, 'loss': 0.8413938283920288}
2024-08-20 02:51:55,040:INFO: Epoch: 2/5, Step: 367/703, Lr: 0.000000079-0.000788261-0.000973342, Loss: 0.841394, Time/step: 1.090767
2024-08-20 02:52:05,977:INFO: {'sim_loss': 1.0148812532424927, 'siou_loss': 0.10161086916923523, 'loss': 1.0656867027282715}
2024-08-20 02:52:05,979:INFO: Epoch: 2/5, Step: 377/703, Lr: 0.000000078-0.000784598-0.000971884, Loss: 1.065687, Time/step: 1.093914
2024-08-20 02:52:16,684:INFO: {'sim_loss': 0.7658125758171082, 'siou_loss': 0.09832978248596191, 'loss': 0.8149774670600891}
2024-08-20 02:52:16,686:INFO: Epoch: 2/5, Step: 387/703, Lr: 0.000000078-0.000780912-0.000970387, Loss: 0.814977, Time/step: 1.070729
2024-08-20 02:52:27,535:INFO: {'sim_loss': 1.0024961233139038, 'siou_loss': 0.0981423556804657, 'loss': 1.0515673160552979}
2024-08-20 02:52:27,537:INFO: Epoch: 2/5, Step: 397/703, Lr: 0.000000078-0.000777204-0.000968854, Loss: 1.051567, Time/step: 1.085074
2024-08-20 02:52:38,526:INFO: {'sim_loss': 0.996283769607544, 'siou_loss': 0.09370803833007812, 'loss': 1.043137788772583}
2024-08-20 02:52:38,529:INFO: Epoch: 2/5, Step: 407/703, Lr: 0.000000077-0.000773474-0.000967282, Loss: 1.043138, Time/step: 1.099131
2024-08-20 02:52:49,422:INFO: {'sim_loss': 0.9962083101272583, 'siou_loss': 0.09643271565437317, 'loss': 1.0444246530532837}
2024-08-20 02:52:49,424:INFO: Epoch: 2/5, Step: 417/703, Lr: 0.000000077-0.000769722-0.000965674, Loss: 1.044425, Time/step: 1.089509
2024-08-20 02:53:00,357:INFO: {'sim_loss': 0.8685473203659058, 'siou_loss': 0.0971955955028534, 'loss': 0.9171451330184937}
2024-08-20 02:53:00,360:INFO: Epoch: 2/5, Step: 427/703, Lr: 0.000000077-0.000765948-0.000964028, Loss: 0.917145, Time/step: 1.093552
2024-08-20 02:53:11,248:INFO: {'sim_loss': 0.8538099527359009, 'siou_loss': 0.1029326319694519, 'loss': 0.9052762985229492}
2024-08-20 02:53:11,250:INFO: Epoch: 2/5, Step: 437/703, Lr: 0.000000076-0.000762154-0.000962345, Loss: 0.905276, Time/step: 1.089046
2024-08-20 02:53:22,020:INFO: {'sim_loss': 0.8291528224945068, 'siou_loss': 0.1023230254650116, 'loss': 0.8803143501281738}
2024-08-20 02:53:22,040:INFO: Epoch: 2/5, Step: 447/703, Lr: 0.000000076-0.000758338-0.000960625, Loss: 0.880314, Time/step: 1.078969
2024-08-20 02:53:32,933:INFO: {'sim_loss': 0.7726036310195923, 'siou_loss': 0.09662196040153503, 'loss': 0.820914626121521}
2024-08-20 02:53:32,937:INFO: Epoch: 2/5, Step: 457/703, Lr: 0.000000075-0.000754501-0.000958868, Loss: 0.820915, Time/step: 1.089665
2024-08-20 02:53:43,831:INFO: {'sim_loss': 0.7967648506164551, 'siou_loss': 0.0970970094203949, 'loss': 0.8453133702278137}
2024-08-20 02:53:43,833:INFO: Epoch: 2/5, Step: 467/703, Lr: 0.000000075-0.000750645-0.000957075, Loss: 0.845313, Time/step: 1.089552
2024-08-20 02:53:54,716:INFO: {'sim_loss': 1.024190068244934, 'siou_loss': 0.09740075469017029, 'loss': 1.0728904008865356}
2024-08-20 02:53:54,718:INFO: Epoch: 2/5, Step: 477/703, Lr: 0.000000075-0.000746768-0.000955245, Loss: 1.072890, Time/step: 1.088514
2024-08-20 02:54:05,793:INFO: {'sim_loss': 0.8615447282791138, 'siou_loss': 0.09888717532157898, 'loss': 0.9109883308410645}
2024-08-20 02:54:05,797:INFO: Epoch: 2/5, Step: 487/703, Lr: 0.000000074-0.000742872-0.000953379, Loss: 0.910988, Time/step: 1.107861
2024-08-20 02:54:16,597:INFO: {'sim_loss': 0.9607572555541992, 'siou_loss': 0.10241863131523132, 'loss': 1.011966586112976}
2024-08-20 02:54:16,600:INFO: Epoch: 2/5, Step: 497/703, Lr: 0.000000074-0.000738956-0.000951477, Loss: 1.011967, Time/step: 1.080272
2024-08-20 02:54:27,472:INFO: {'sim_loss': 0.8283292055130005, 'siou_loss': 0.09815090894699097, 'loss': 0.8774046897888184}
2024-08-20 02:54:27,475:INFO: Epoch: 2/5, Step: 507/703, Lr: 0.000000074-0.000735021-0.000949538, Loss: 0.877405, Time/step: 1.087471
2024-08-20 02:54:38,348:INFO: {'sim_loss': 0.8794273138046265, 'siou_loss': 0.10170790553092957, 'loss': 0.9302812814712524}
2024-08-20 02:54:38,351:INFO: Epoch: 2/5, Step: 517/703, Lr: 0.000000073-0.000731067-0.000947564, Loss: 0.930281, Time/step: 1.087594
2024-08-20 02:54:49,449:INFO: {'sim_loss': 0.9487258195877075, 'siou_loss': 0.09959593415260315, 'loss': 0.9985237717628479}
2024-08-20 02:54:49,452:INFO: Epoch: 2/5, Step: 527/703, Lr: 0.000000073-0.000727095-0.000945554, Loss: 0.998524, Time/step: 1.110091
2024-08-20 02:55:00,350:INFO: {'sim_loss': 0.8657732009887695, 'siou_loss': 0.09847956895828247, 'loss': 0.9150129556655884}
2024-08-20 02:55:00,352:INFO: Epoch: 2/5, Step: 537/703, Lr: 0.000000072-0.000723104-0.000943508, Loss: 0.915013, Time/step: 1.089980
2024-08-20 02:55:11,104:INFO: {'sim_loss': 0.8869829177856445, 'siou_loss': 0.10510116815567017, 'loss': 0.9395334720611572}
2024-08-20 02:55:11,107:INFO: Epoch: 2/5, Step: 547/703, Lr: 0.000000072-0.000719096-0.000941427, Loss: 0.939533, Time/step: 1.075433
2024-08-20 02:55:21,755:INFO: {'sim_loss': 0.7802077531814575, 'siou_loss': 0.09781873226165771, 'loss': 0.8291171193122864}
2024-08-20 02:55:21,757:INFO: Epoch: 2/5, Step: 557/703, Lr: 0.000000072-0.000715071-0.000939311, Loss: 0.829117, Time/step: 1.065001
2024-08-20 02:55:32,458:INFO: {'sim_loss': 0.9732099771499634, 'siou_loss': 0.09969261288642883, 'loss': 1.0230562686920166}
2024-08-20 02:55:32,460:INFO: Epoch: 2/5, Step: 567/703, Lr: 0.000000071-0.000711028-0.000937159, Loss: 1.023056, Time/step: 1.070297
2024-08-20 02:55:43,394:INFO: {'sim_loss': 0.844024658203125, 'siou_loss': 0.10211235284805298, 'loss': 0.8950808048248291}
2024-08-20 02:55:43,397:INFO: Epoch: 2/5, Step: 577/703, Lr: 0.000000071-0.000706968-0.000934973, Loss: 0.895081, Time/step: 1.093651
2024-08-20 02:55:54,345:INFO: {'sim_loss': 0.7613840103149414, 'siou_loss': 0.09710773825645447, 'loss': 0.8099378943443298}
2024-08-20 02:55:54,348:INFO: Epoch: 2/5, Step: 587/703, Lr: 0.000000070-0.000702892-0.000932752, Loss: 0.809938, Time/step: 1.095066
2024-08-20 02:56:05,424:INFO: {'sim_loss': 1.0258307456970215, 'siou_loss': 0.09910035133361816, 'loss': 1.0753809213638306}
2024-08-20 02:56:05,426:INFO: Epoch: 2/5, Step: 597/703, Lr: 0.000000070-0.000698799-0.000930496, Loss: 1.075381, Time/step: 1.107813
2024-08-20 02:56:16,497:INFO: {'sim_loss': 0.7425945401191711, 'siou_loss': 0.09625968337059021, 'loss': 0.7907243967056274}
2024-08-20 02:56:16,499:INFO: Epoch: 2/5, Step: 607/703, Lr: 0.000000069-0.000694691-0.000928206, Loss: 0.790724, Time/step: 1.107315
2024-08-20 02:56:27,399:INFO: {'sim_loss': 0.7556947469711304, 'siou_loss': 0.0968683660030365, 'loss': 0.8041289448738098}
2024-08-20 02:56:27,401:INFO: Epoch: 2/5, Step: 617/703, Lr: 0.000000069-0.000690567-0.000925882, Loss: 0.804129, Time/step: 1.090137
2024-08-20 02:56:37,993:INFO: {'sim_loss': 0.8101917505264282, 'siou_loss': 0.09842035174369812, 'loss': 0.8594019412994385}
2024-08-20 02:56:37,996:INFO: Epoch: 2/5, Step: 627/703, Lr: 0.000000069-0.000686428-0.000923523, Loss: 0.859402, Time/step: 1.059469
2024-08-20 02:56:48,714:INFO: {'sim_loss': 0.9671009182929993, 'siou_loss': 0.09661665558815002, 'loss': 1.015409231185913}
2024-08-20 02:56:48,717:INFO: Epoch: 2/5, Step: 637/703, Lr: 0.000000068-0.000682274-0.000921131, Loss: 1.015409, Time/step: 1.072062
2024-08-20 02:56:59,588:INFO: {'sim_loss': 0.8745540380477905, 'siou_loss': 0.09528830647468567, 'loss': 0.9221981763839722}
2024-08-20 02:56:59,591:INFO: Epoch: 2/5, Step: 647/703, Lr: 0.000000068-0.000678106-0.000918705, Loss: 0.922198, Time/step: 1.087398
2024-08-20 02:57:10,224:INFO: {'sim_loss': 0.7835060358047485, 'siou_loss': 0.09396901726722717, 'loss': 0.8304905295372009}
2024-08-20 02:57:10,226:INFO: Epoch: 2/5, Step: 657/703, Lr: 0.000000067-0.000673923-0.000916246, Loss: 0.830491, Time/step: 1.063488
2024-08-20 02:57:21,131:INFO: {'sim_loss': 0.8365224599838257, 'siou_loss': 0.10010799765586853, 'loss': 0.8865764737129211}
2024-08-20 02:57:21,134:INFO: Epoch: 2/5, Step: 667/703, Lr: 0.000000067-0.000669726-0.000913754, Loss: 0.886576, Time/step: 1.090796
2024-08-20 02:57:32,056:INFO: {'sim_loss': 0.8127139806747437, 'siou_loss': 0.09579750895500183, 'loss': 0.8606127500534058}
2024-08-20 02:57:32,059:INFO: Epoch: 2/5, Step: 677/703, Lr: 0.000000067-0.000665516-0.000911228, Loss: 0.860613, Time/step: 1.092510
2024-08-20 02:57:42,813:INFO: {'sim_loss': 0.8572194576263428, 'siou_loss': 0.09516611695289612, 'loss': 0.9048025012016296}
2024-08-20 02:57:42,815:INFO: Epoch: 2/5, Step: 687/703, Lr: 0.000000066-0.000661293-0.000908670, Loss: 0.904803, Time/step: 1.075549
2024-08-20 02:57:52,911:INFO: {'sim_loss': 0.8410186767578125, 'siou_loss': 0.09222885966300964, 'loss': 0.8871331214904785}
2024-08-20 02:57:52,913:INFO: Epoch: 2/5, Step: 697/703, Lr: 0.000000066-0.000657056-0.000906079, Loss: 0.887133, Time/step: 1.009765
2024-08-20 02:57:59,121:INFO: Eval on val dataset
2024-08-20 02:57:59,122:INFO: Epoch 2/5 Finished, Train Loss: 0.968196
2024-08-20 02:57:59,122:INFO: Eval on val dataset
2024-08-20 02:58:10,542:INFO: sim matrix size: 1000, 1000
2024-08-20 02:58:10,645:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 02:58:10,646:INFO: 	>>>[1406][constrast] Text-to-Video  R@1: 47.2 - R@5: 72.2 - R@10: 83.1 - Median R: 2.0 - Mean R: 13.1
2024-08-20 02:58:10,646:INFO: 	>>> [1406][constrast] V2T$R@1: 46.5 - V2T$R@5: 74.6 - V2T$R@10: 82.4 - V2T$Median R: 2.0 - V2T$Mean R: 9.1
2024-08-20 02:58:11,344:INFO: The best model is: outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth, the R1 is: 47.2000
2024-08-20 02:58:11,455:INFO: Start generating the context prototype set.
2024-08-20 02:58:11,456:INFO: Start generating the context prototype set.
2024-08-20 02:58:11,457:INFO: Start generating the context prototype set.
2024-08-20 02:58:11,458:INFO: Start generating the context prototype set.
2024-08-20 02:58:42,167:INFO: Initializion of the memory banks done.
2024-08-20 02:58:42,270:INFO: Initializion of the memory banks done.
2024-08-20 02:58:42,320:INFO: Initializion of the memory banks done.
2024-08-20 02:58:42,468:INFO: Initializion of the memory banks done.
2024-08-20 02:58:42,520:INFO: Start to do clustering...
2024-08-20 02:58:42,520:INFO: Start to do clustering...
2024-08-20 02:58:42,520:INFO: Start to do clustering...
2024-08-20 02:58:42,521:INFO: Start to do clustering...
2024-08-20 02:58:42,521:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6364054083824158
2024-08-20 02:58:42,521:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6364054083824158
2024-08-20 02:58:42,521:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6364054083824158
2024-08-20 02:58:42,522:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6364054083824158
2024-08-20 02:58:42,524:INFO: [rank=0] centroids: 0.653309166431427
2024-08-20 02:58:42,524:INFO: [rank=1] centroids: 0.653309166431427
2024-08-20 02:58:42,725:INFO: [rank=0] centroids: 0.6498377323150635
2024-08-20 02:58:42,725:INFO: [rank=1] centroids: 0.6498377323150635
2024-08-20 02:58:42,923:INFO: [rank=0] centroids: 0.6503822803497314
2024-08-20 02:58:42,923:INFO: [rank=1] centroids: 0.6503822803497314
2024-08-20 02:58:43,119:INFO: [rank=1] centroids: 0.6504544615745544
2024-08-20 02:58:43,119:INFO: [rank=0] centroids: 0.6504544615745544
2024-08-20 02:58:43,342:INFO: [rank=0] centroids: 0.6503841876983643
2024-08-20 02:58:43,342:INFO: [rank=1] centroids: 0.6503841876983643
2024-08-20 02:58:43,534:INFO: [rank=1] centroids: 0.6504905223846436
2024-08-20 02:58:43,534:INFO: [rank=0] centroids: 0.6504905223846436
2024-08-20 02:58:43,731:INFO: [rank=0] centroids: 0.65021151304245
2024-08-20 02:58:43,731:INFO: [rank=1] centroids: 0.65021151304245
2024-08-20 02:58:43,925:INFO: [rank=1] centroids: 0.6502342820167542
2024-08-20 02:58:43,925:INFO: [rank=0] centroids: 0.6502342820167542
2024-08-20 02:58:44,122:INFO: [rank=0] centroids: 0.650233805179596
2024-08-20 02:58:44,122:INFO: [rank=1] centroids: 0.650233805179596
2024-08-20 02:58:44,318:INFO: [rank=1] centroids: 0.6501265168190002
2024-08-20 02:58:44,318:INFO: [rank=0] centroids: 0.6501265168190002
2024-08-20 02:58:44,512:INFO: [rank=1] centroids: 0.6501660346984863
2024-08-20 02:58:44,516:INFO: [rank=0] centroids: 0.6501660346984863
2024-08-20 02:58:44,571:INFO: Clustering done.
2024-08-20 02:58:44,571:INFO: Clustering done.
2024-08-20 02:58:44,571:INFO: Clustering done.
2024-08-20 02:58:44,572:INFO: Context prototype set generated.
2024-08-20 02:58:44,572:INFO: Context prototype set generated.
2024-08-20 02:58:44,572:INFO: Context prototype set generated.
2024-08-20 02:58:44,576:INFO: Clustering done.
2024-08-20 02:58:44,576:INFO: Context prototype set generated.
2024-08-20 02:58:55,428:INFO: {'sim_loss': 0.932148277759552, 'siou_loss': 0.17639708518981934, 'loss': 1.0203468799591064}
2024-08-20 02:58:55,431:INFO: Epoch: 3/5, Step: 1/703, Lr: 0.000000065-0.000654083-0.000904246, Loss: 1.020347, Time/step: 4.397578
2024-08-20 02:58:56,507:INFO: {'sim_loss': 0.744513213634491, 'siou_loss': 0.1730053722858429, 'loss': 0.8310158848762512}
2024-08-20 02:58:56,509:INFO: Epoch: 3/5, Step: 2/703, Lr: 0.000000065-0.000653658-0.000903983, Loss: 0.831016, Time/step: 0.107777
2024-08-20 02:58:57,563:INFO: {'sim_loss': 0.6747840046882629, 'siou_loss': 0.17444035410881042, 'loss': 0.7620041966438293}
2024-08-20 02:58:57,565:INFO: Epoch: 3/5, Step: 3/703, Lr: 0.000000065-0.000653233-0.000903719, Loss: 0.762004, Time/step: 0.105552
2024-08-20 02:58:58,648:INFO: {'sim_loss': 0.6566866636276245, 'siou_loss': 0.17267391085624695, 'loss': 0.7430236339569092}
2024-08-20 02:58:58,650:INFO: Epoch: 3/5, Step: 4/703, Lr: 0.000000065-0.000652807-0.000903455, Loss: 0.743024, Time/step: 0.108543
2024-08-20 02:59:10,095:INFO: {'sim_loss': 0.6645398139953613, 'siou_loss': 0.16828811168670654, 'loss': 0.7486838698387146}
2024-08-20 02:59:10,097:INFO: Epoch: 3/5, Step: 14/703, Lr: 0.000000065-0.000648546-0.000900800, Loss: 0.748684, Time/step: 1.144680
2024-08-20 02:59:21,223:INFO: {'sim_loss': 0.6681408882141113, 'siou_loss': 0.1674967110157013, 'loss': 0.7518892288208008}
2024-08-20 02:59:21,226:INFO: Epoch: 3/5, Step: 24/703, Lr: 0.000000064-0.000644273-0.000898112, Loss: 0.751889, Time/step: 1.112841
2024-08-20 02:59:32,196:INFO: {'sim_loss': 0.7651185393333435, 'siou_loss': 0.16624349355697632, 'loss': 0.8482402563095093}
2024-08-20 02:59:32,199:INFO: Epoch: 3/5, Step: 34/703, Lr: 0.000000064-0.000639989-0.000895392, Loss: 0.848240, Time/step: 1.097262
2024-08-20 02:59:43,039:INFO: {'sim_loss': 0.6597485542297363, 'siou_loss': 0.16566044092178345, 'loss': 0.7425787448883057}
2024-08-20 02:59:43,044:INFO: Epoch: 3/5, Step: 44/703, Lr: 0.000000064-0.000635693-0.000892641, Loss: 0.742579, Time/step: 1.084538
2024-08-20 02:59:53,789:INFO: {'sim_loss': 0.6068400740623474, 'siou_loss': 0.16638422012329102, 'loss': 0.6900321841239929}
2024-08-20 02:59:53,792:INFO: Epoch: 3/5, Step: 54/703, Lr: 0.000000063-0.000631387-0.000889859, Loss: 0.690032, Time/step: 1.074710
2024-08-20 03:00:04,715:INFO: {'sim_loss': 0.7752254009246826, 'siou_loss': 0.16780167818069458, 'loss': 0.8591262102127075}
2024-08-20 03:00:04,717:INFO: Epoch: 3/5, Step: 64/703, Lr: 0.000000063-0.000627070-0.000887045, Loss: 0.859126, Time/step: 1.092557
2024-08-20 03:00:15,834:INFO: {'sim_loss': 0.7917395830154419, 'siou_loss': 0.168889582157135, 'loss': 0.876184344291687}
2024-08-20 03:00:15,836:INFO: Epoch: 3/5, Step: 74/703, Lr: 0.000000062-0.000622743-0.000884201, Loss: 0.876184, Time/step: 1.111875
2024-08-20 03:00:26,841:INFO: {'sim_loss': 0.8177952766418457, 'siou_loss': 0.16945132613182068, 'loss': 0.9025209546089172}
2024-08-20 03:00:26,844:INFO: Epoch: 3/5, Step: 84/703, Lr: 0.000000062-0.000618406-0.000881325, Loss: 0.902521, Time/step: 1.100789
2024-08-20 03:00:38,121:INFO: {'sim_loss': 0.6022580862045288, 'siou_loss': 0.1645776629447937, 'loss': 0.684546947479248}
2024-08-20 03:00:38,126:INFO: Epoch: 3/5, Step: 94/703, Lr: 0.000000061-0.000614059-0.000878420, Loss: 0.684547, Time/step: 1.128145
2024-08-20 03:00:49,042:INFO: {'sim_loss': 0.6619457006454468, 'siou_loss': 0.16640201210975647, 'loss': 0.7451466917991638}
2024-08-20 03:00:49,045:INFO: Epoch: 3/5, Step: 104/703, Lr: 0.000000061-0.000609704-0.000875484, Loss: 0.745147, Time/step: 1.091910
2024-08-20 03:00:59,882:INFO: {'sim_loss': 0.7693226933479309, 'siou_loss': 0.16481003165245056, 'loss': 0.8517277240753174}
2024-08-20 03:00:59,885:INFO: Epoch: 3/5, Step: 114/703, Lr: 0.000000061-0.000605340-0.000872518, Loss: 0.851728, Time/step: 1.083948
2024-08-20 03:01:10,845:INFO: {'sim_loss': 0.6523191928863525, 'siou_loss': 0.16568872332572937, 'loss': 0.7351635694503784}
2024-08-20 03:01:10,848:INFO: Epoch: 3/5, Step: 124/703, Lr: 0.000000060-0.000600967-0.000869522, Loss: 0.735164, Time/step: 1.096321
2024-08-20 03:01:21,862:INFO: {'sim_loss': 0.6903645992279053, 'siou_loss': 0.16423547267913818, 'loss': 0.7724823355674744}
2024-08-20 03:01:21,865:INFO: Epoch: 3/5, Step: 134/703, Lr: 0.000000060-0.000596586-0.000866497, Loss: 0.772482, Time/step: 1.101674
2024-08-20 03:01:32,674:INFO: {'sim_loss': 0.8271229267120361, 'siou_loss': 0.16576889157295227, 'loss': 0.9100073575973511}
2024-08-20 03:01:32,677:INFO: Epoch: 3/5, Step: 144/703, Lr: 0.000000059-0.000592198-0.000863443, Loss: 0.910007, Time/step: 1.081167
2024-08-20 03:01:43,462:INFO: {'sim_loss': 0.6672325730323792, 'siou_loss': 0.16412222385406494, 'loss': 0.7492936849594116}
2024-08-20 03:01:43,465:INFO: Epoch: 3/5, Step: 154/703, Lr: 0.000000059-0.000587802-0.000860359, Loss: 0.749294, Time/step: 1.078720
2024-08-20 03:01:54,376:INFO: {'sim_loss': 0.6684894561767578, 'siou_loss': 0.16205570101737976, 'loss': 0.7495173215866089}
2024-08-20 03:01:54,378:INFO: Epoch: 3/5, Step: 164/703, Lr: 0.000000058-0.000583399-0.000857247, Loss: 0.749517, Time/step: 1.091361
2024-08-20 03:02:05,230:INFO: {'sim_loss': 0.7809398174285889, 'siou_loss': 0.16386768221855164, 'loss': 0.8628736734390259}
2024-08-20 03:02:05,232:INFO: Epoch: 3/5, Step: 174/703, Lr: 0.000000058-0.000578990-0.000854106, Loss: 0.862874, Time/step: 1.085382
2024-08-20 03:02:16,347:INFO: {'sim_loss': 0.6562370657920837, 'siou_loss': 0.16467121243476868, 'loss': 0.7385726571083069}
2024-08-20 03:02:16,350:INFO: Epoch: 3/5, Step: 184/703, Lr: 0.000000057-0.000574574-0.000850937, Loss: 0.738573, Time/step: 1.111717
2024-08-20 03:02:27,196:INFO: {'sim_loss': 0.7747455835342407, 'siou_loss': 0.16112327575683594, 'loss': 0.8553072214126587}
2024-08-20 03:02:27,198:INFO: Epoch: 3/5, Step: 194/703, Lr: 0.000000057-0.000570152-0.000847740, Loss: 0.855307, Time/step: 1.084850
2024-08-20 03:02:38,047:INFO: {'sim_loss': 0.6651883125305176, 'siou_loss': 0.15899303555488586, 'loss': 0.7446848154067993}
2024-08-20 03:02:38,050:INFO: Epoch: 3/5, Step: 204/703, Lr: 0.000000057-0.000565725-0.000844515, Loss: 0.744685, Time/step: 1.085124
2024-08-20 03:02:49,083:INFO: {'sim_loss': 0.6228057146072388, 'siou_loss': 0.15761372447013855, 'loss': 0.7016125917434692}
2024-08-20 03:02:49,085:INFO: Epoch: 3/5, Step: 214/703, Lr: 0.000000056-0.000561292-0.000841262, Loss: 0.701613, Time/step: 1.103512
2024-08-20 03:03:00,026:INFO: {'sim_loss': 0.7064946889877319, 'siou_loss': 0.16080302000045776, 'loss': 0.7868962287902832}
2024-08-20 03:03:00,028:INFO: Epoch: 3/5, Step: 224/703, Lr: 0.000000056-0.000556854-0.000837983, Loss: 0.786896, Time/step: 1.094299
2024-08-20 03:03:11,146:INFO: {'sim_loss': 0.9201686382293701, 'siou_loss': 0.16155913472175598, 'loss': 1.000948190689087}
2024-08-20 03:03:11,150:INFO: Epoch: 3/5, Step: 234/703, Lr: 0.000000055-0.000552412-0.000834676, Loss: 1.000948, Time/step: 1.112179
2024-08-20 03:03:22,040:INFO: {'sim_loss': 0.5974172353744507, 'siou_loss': 0.15703359246253967, 'loss': 0.6759340167045593}
2024-08-20 03:03:22,042:INFO: Epoch: 3/5, Step: 244/703, Lr: 0.000000055-0.000547966-0.000831343, Loss: 0.675934, Time/step: 1.089200
2024-08-20 03:03:33,016:INFO: {'sim_loss': 0.6386624574661255, 'siou_loss': 0.15641391277313232, 'loss': 0.7168694138526917}
2024-08-20 03:03:33,018:INFO: Epoch: 3/5, Step: 254/703, Lr: 0.000000054-0.000543516-0.000827983, Loss: 0.716869, Time/step: 1.097565
2024-08-20 03:03:43,785:INFO: {'sim_loss': 0.8303477168083191, 'siou_loss': 0.15530261397361755, 'loss': 0.9079990386962891}
2024-08-20 03:03:43,788:INFO: Epoch: 3/5, Step: 264/703, Lr: 0.000000054-0.000539062-0.000824597, Loss: 0.907999, Time/step: 1.076922
2024-08-20 03:03:54,603:INFO: {'sim_loss': 0.7161107659339905, 'siou_loss': 0.1583336591720581, 'loss': 0.7952775955200195}
2024-08-20 03:03:54,606:INFO: Epoch: 3/5, Step: 274/703, Lr: 0.000000053-0.000534606-0.000821185, Loss: 0.795278, Time/step: 1.081812
2024-08-20 03:04:05,549:INFO: {'sim_loss': 0.8085782527923584, 'siou_loss': 0.15401259064674377, 'loss': 0.8855845332145691}
2024-08-20 03:04:05,552:INFO: Epoch: 3/5, Step: 284/703, Lr: 0.000000053-0.000530146-0.000817747, Loss: 0.885585, Time/step: 1.094585
2024-08-20 03:04:16,375:INFO: {'sim_loss': 0.7049781084060669, 'siou_loss': 0.15100562572479248, 'loss': 0.7804809212684631}
2024-08-20 03:04:16,378:INFO: Epoch: 3/5, Step: 294/703, Lr: 0.000000053-0.000525685-0.000814284, Loss: 0.780481, Time/step: 1.082569
2024-08-20 03:04:27,441:INFO: {'sim_loss': 0.6321550607681274, 'siou_loss': 0.15245085954666138, 'loss': 0.7083804607391357}
2024-08-20 03:04:27,443:INFO: Epoch: 3/5, Step: 304/703, Lr: 0.000000052-0.000521221-0.000810796, Loss: 0.708380, Time/step: 1.106525
2024-08-20 03:04:38,239:INFO: {'sim_loss': 0.7885108590126038, 'siou_loss': 0.1504349708557129, 'loss': 0.8637283444404602}
2024-08-20 03:04:38,242:INFO: Epoch: 3/5, Step: 314/703, Lr: 0.000000052-0.000516755-0.000807283, Loss: 0.863728, Time/step: 1.079829
2024-08-20 03:04:49,088:INFO: {'sim_loss': 0.7320548295974731, 'siou_loss': 0.15356779098510742, 'loss': 0.8088387250900269}
2024-08-20 03:04:49,091:INFO: Epoch: 3/5, Step: 324/703, Lr: 0.000000051-0.000512288-0.000803745, Loss: 0.808839, Time/step: 1.084957
2024-08-20 03:04:59,912:INFO: {'sim_loss': 0.7126115560531616, 'siou_loss': 0.1516636312007904, 'loss': 0.788443386554718}
2024-08-20 03:04:59,915:INFO: Epoch: 3/5, Step: 334/703, Lr: 0.000000051-0.000507820-0.000800183, Loss: 0.788443, Time/step: 1.082344
2024-08-20 03:05:10,855:INFO: {'sim_loss': 0.7193330526351929, 'siou_loss': 0.1518886387348175, 'loss': 0.7952773571014404}
2024-08-20 03:05:10,857:INFO: Epoch: 3/5, Step: 344/703, Lr: 0.000000050-0.000503352-0.000796598, Loss: 0.795277, Time/step: 1.094211
2024-08-20 03:05:21,734:INFO: {'sim_loss': 0.7108937501907349, 'siou_loss': 0.1499330997467041, 'loss': 0.7858603000640869}
2024-08-20 03:05:21,736:INFO: Epoch: 3/5, Step: 354/703, Lr: 0.000000050-0.000498883-0.000792988, Loss: 0.785860, Time/step: 1.087870
2024-08-20 03:05:32,821:INFO: {'sim_loss': 0.7769818305969238, 'siou_loss': 0.15074864029884338, 'loss': 0.8523561358451843}
2024-08-20 03:05:32,824:INFO: Epoch: 3/5, Step: 364/703, Lr: 0.000000049-0.000494414-0.000789355, Loss: 0.852356, Time/step: 1.108741
2024-08-20 03:05:43,602:INFO: {'sim_loss': 0.7583409547805786, 'siou_loss': 0.14627957344055176, 'loss': 0.8314807415008545}
2024-08-20 03:05:43,605:INFO: Epoch: 3/5, Step: 374/703, Lr: 0.000000049-0.000489946-0.000785699, Loss: 0.831481, Time/step: 1.078159
2024-08-20 03:05:54,381:INFO: {'sim_loss': 0.610916256904602, 'siou_loss': 0.14510977268218994, 'loss': 0.683471143245697}
2024-08-20 03:05:54,383:INFO: Epoch: 3/5, Step: 384/703, Lr: 0.000000049-0.000485478-0.000782020, Loss: 0.683471, Time/step: 1.077743
2024-08-20 03:06:05,223:INFO: {'sim_loss': 0.7189761996269226, 'siou_loss': 0.146918386220932, 'loss': 0.7924354076385498}
2024-08-20 03:06:05,226:INFO: Epoch: 3/5, Step: 394/703, Lr: 0.000000048-0.000481012-0.000778319, Loss: 0.792435, Time/step: 1.084299
2024-08-20 03:06:16,079:INFO: {'sim_loss': 0.580282986164093, 'siou_loss': 0.1496117115020752, 'loss': 0.6550888419151306}
2024-08-20 03:06:16,082:INFO: Epoch: 3/5, Step: 404/703, Lr: 0.000000048-0.000476547-0.000774595, Loss: 0.655089, Time/step: 1.085541
2024-08-20 03:06:27,049:INFO: {'sim_loss': 0.7466417551040649, 'siou_loss': 0.14763891696929932, 'loss': 0.8204612135887146}
2024-08-20 03:06:27,052:INFO: Epoch: 3/5, Step: 414/703, Lr: 0.000000047-0.000472084-0.000770850, Loss: 0.820461, Time/step: 1.096977
2024-08-20 03:06:37,924:INFO: {'sim_loss': 0.7764217853546143, 'siou_loss': 0.14800578355789185, 'loss': 0.8504246473312378}
2024-08-20 03:06:37,927:INFO: Epoch: 3/5, Step: 424/703, Lr: 0.000000047-0.000467624-0.000767083, Loss: 0.850425, Time/step: 1.087569
2024-08-20 03:06:48,894:INFO: {'sim_loss': 0.7031452059745789, 'siou_loss': 0.14409378170967102, 'loss': 0.7751920819282532}
2024-08-20 03:06:48,897:INFO: Epoch: 3/5, Step: 434/703, Lr: 0.000000046-0.000463165-0.000763294, Loss: 0.775192, Time/step: 1.096950
2024-08-20 03:06:59,732:INFO: {'sim_loss': 0.5753130912780762, 'siou_loss': 0.14030882716178894, 'loss': 0.6454675197601318}
2024-08-20 03:06:59,735:INFO: Epoch: 3/5, Step: 444/703, Lr: 0.000000046-0.000458710-0.000759485, Loss: 0.645468, Time/step: 1.083738
2024-08-20 03:07:10,756:INFO: {'sim_loss': 0.8156886100769043, 'siou_loss': 0.1429106593132019, 'loss': 0.8871439695358276}
2024-08-20 03:07:10,758:INFO: Epoch: 3/5, Step: 454/703, Lr: 0.000000045-0.000454258-0.000755655, Loss: 0.887144, Time/step: 1.102349
2024-08-20 03:07:21,565:INFO: {'sim_loss': 0.6541566848754883, 'siou_loss': 0.1438889503479004, 'loss': 0.7261011600494385}
2024-08-20 03:07:21,568:INFO: Epoch: 3/5, Step: 464/703, Lr: 0.000000045-0.000449810-0.000751804, Loss: 0.726101, Time/step: 1.080939
2024-08-20 03:07:32,343:INFO: {'sim_loss': 0.6333790421485901, 'siou_loss': 0.14182865619659424, 'loss': 0.7042933702468872}
2024-08-20 03:07:32,345:INFO: Epoch: 3/5, Step: 474/703, Lr: 0.000000045-0.000445366-0.000747933, Loss: 0.704293, Time/step: 1.077716
2024-08-20 03:07:43,175:INFO: {'sim_loss': 0.654127836227417, 'siou_loss': 0.14413079619407654, 'loss': 0.7261932492256165}
2024-08-20 03:07:43,177:INFO: Epoch: 3/5, Step: 484/703, Lr: 0.000000044-0.000440926-0.000744043, Loss: 0.726193, Time/step: 1.083191
2024-08-20 03:07:53,971:INFO: {'sim_loss': 0.5809484124183655, 'siou_loss': 0.14306855201721191, 'loss': 0.6524826884269714}
2024-08-20 03:07:53,973:INFO: Epoch: 3/5, Step: 494/703, Lr: 0.000000044-0.000436491-0.000740132, Loss: 0.652483, Time/step: 1.079588
2024-08-20 03:08:04,829:INFO: {'sim_loss': 0.7297062873840332, 'siou_loss': 0.144492506980896, 'loss': 0.8019525408744812}
2024-08-20 03:08:04,831:INFO: Epoch: 3/5, Step: 504/703, Lr: 0.000000043-0.000432061-0.000736203, Loss: 0.801953, Time/step: 1.085737
2024-08-20 03:08:15,764:INFO: {'sim_loss': 0.8114959001541138, 'siou_loss': 0.14585483074188232, 'loss': 0.8844233155250549}
2024-08-20 03:08:15,766:INFO: Epoch: 3/5, Step: 514/703, Lr: 0.000000043-0.000427636-0.000732255, Loss: 0.884423, Time/step: 1.093527
2024-08-20 03:08:26,750:INFO: {'sim_loss': 0.5300219058990479, 'siou_loss': 0.14241138100624084, 'loss': 0.6012275815010071}
2024-08-20 03:08:26,753:INFO: Epoch: 3/5, Step: 524/703, Lr: 0.000000042-0.000423218-0.000728288, Loss: 0.601228, Time/step: 1.098608
2024-08-20 03:08:37,693:INFO: {'sim_loss': 0.5965014696121216, 'siou_loss': 0.1391116976737976, 'loss': 0.6660573482513428}
2024-08-20 03:08:37,696:INFO: Epoch: 3/5, Step: 534/703, Lr: 0.000000042-0.000418805-0.000724303, Loss: 0.666057, Time/step: 1.094293
2024-08-20 03:08:48,589:INFO: {'sim_loss': 0.7378299236297607, 'siou_loss': 0.14060157537460327, 'loss': 0.8081307411193848}
2024-08-20 03:08:48,592:INFO: Epoch: 3/5, Step: 544/703, Lr: 0.000000041-0.000414399-0.000720301, Loss: 0.808131, Time/step: 1.089576
2024-08-20 03:08:59,497:INFO: {'sim_loss': 0.7345664501190186, 'siou_loss': 0.1386532485485077, 'loss': 0.8038930892944336}
2024-08-20 03:08:59,499:INFO: Epoch: 3/5, Step: 554/703, Lr: 0.000000041-0.000409999-0.000716280, Loss: 0.803893, Time/step: 1.090706
2024-08-20 03:09:10,681:INFO: {'sim_loss': 0.7723015546798706, 'siou_loss': 0.14154395461082458, 'loss': 0.8430735468864441}
2024-08-20 03:09:10,685:INFO: Epoch: 3/5, Step: 564/703, Lr: 0.000000041-0.000405607-0.000712242, Loss: 0.843074, Time/step: 1.118617
2024-08-20 03:09:21,627:INFO: {'sim_loss': 0.7575808167457581, 'siou_loss': 0.1374855637550354, 'loss': 0.8263236284255981}
2024-08-20 03:09:21,629:INFO: Epoch: 3/5, Step: 574/703, Lr: 0.000000040-0.000401222-0.000708188, Loss: 0.826324, Time/step: 1.094378
2024-08-20 03:09:32,570:INFO: {'sim_loss': 0.631801962852478, 'siou_loss': 0.13709935545921326, 'loss': 0.7003516554832458}
2024-08-20 03:09:32,573:INFO: Epoch: 3/5, Step: 584/703, Lr: 0.000000040-0.000396846-0.000704117, Loss: 0.700352, Time/step: 1.094360
2024-08-20 03:09:43,461:INFO: {'sim_loss': 0.7184787392616272, 'siou_loss': 0.13950002193450928, 'loss': 0.7882287502288818}
2024-08-20 03:09:43,464:INFO: Epoch: 3/5, Step: 594/703, Lr: 0.000000039-0.000392477-0.000700029, Loss: 0.788229, Time/step: 1.089030
2024-08-20 03:09:54,325:INFO: {'sim_loss': 0.7273402214050293, 'siou_loss': 0.13824233412742615, 'loss': 0.7964614033699036}
2024-08-20 03:09:54,330:INFO: Epoch: 3/5, Step: 604/703, Lr: 0.000000039-0.000388117-0.000695925, Loss: 0.796461, Time/step: 1.086581
2024-08-20 03:10:05,341:INFO: {'sim_loss': 0.8346489667892456, 'siou_loss': 0.13802286982536316, 'loss': 0.9036604166030884}
2024-08-20 03:10:05,344:INFO: Epoch: 3/5, Step: 614/703, Lr: 0.000000038-0.000383766-0.000691806, Loss: 0.903660, Time/step: 1.101409
2024-08-20 03:10:16,232:INFO: {'sim_loss': 0.6681729555130005, 'siou_loss': 0.13678783178329468, 'loss': 0.7365669012069702}
2024-08-20 03:10:16,235:INFO: Epoch: 3/5, Step: 624/703, Lr: 0.000000038-0.000379425-0.000687672, Loss: 0.736567, Time/step: 1.089090
2024-08-20 03:10:27,124:INFO: {'sim_loss': 0.5468575954437256, 'siou_loss': 0.13676071166992188, 'loss': 0.6152379512786865}
2024-08-20 03:10:27,127:INFO: Epoch: 3/5, Step: 634/703, Lr: 0.000000038-0.000375092-0.000683522, Loss: 0.615238, Time/step: 1.089184
2024-08-20 03:10:38,038:INFO: {'sim_loss': 0.6421179175376892, 'siou_loss': 0.13815873861312866, 'loss': 0.7111972570419312}
2024-08-20 03:10:38,041:INFO: Epoch: 3/5, Step: 644/703, Lr: 0.000000037-0.000370770-0.000679358, Loss: 0.711197, Time/step: 1.091446
2024-08-20 03:10:48,990:INFO: {'sim_loss': 0.6291952133178711, 'siou_loss': 0.13396719098091125, 'loss': 0.6961787939071655}
2024-08-20 03:10:48,992:INFO: Epoch: 3/5, Step: 654/703, Lr: 0.000000037-0.000366459-0.000675179, Loss: 0.696179, Time/step: 1.095036
2024-08-20 03:10:59,862:INFO: {'sim_loss': 0.5567268133163452, 'siou_loss': 0.13551965355873108, 'loss': 0.6244866251945496}
2024-08-20 03:10:59,865:INFO: Epoch: 3/5, Step: 664/703, Lr: 0.000000036-0.000362157-0.000670987, Loss: 0.624487, Time/step: 1.087338
2024-08-20 03:11:10,895:INFO: {'sim_loss': 0.6836522817611694, 'siou_loss': 0.14101198315620422, 'loss': 0.7541582584381104}
2024-08-20 03:11:10,898:INFO: Epoch: 3/5, Step: 674/703, Lr: 0.000000036-0.000357867-0.000666781, Loss: 0.754158, Time/step: 1.103241
2024-08-20 03:11:21,889:INFO: {'sim_loss': 0.7443838119506836, 'siou_loss': 0.13999217748641968, 'loss': 0.8143799304962158}
2024-08-20 03:11:21,891:INFO: Epoch: 3/5, Step: 684/703, Lr: 0.000000035-0.000353589-0.000662561, Loss: 0.814380, Time/step: 1.099306
2024-08-20 03:11:32,281:INFO: {'sim_loss': 0.5881891250610352, 'siou_loss': 0.13925597071647644, 'loss': 0.6578171253204346}
2024-08-20 03:11:32,282:INFO: Epoch: 3/5, Step: 694/703, Lr: 0.000000035-0.000349322-0.000658329, Loss: 0.657817, Time/step: 1.039080
2024-08-20 03:11:41,428:INFO: Eval on val dataset
2024-08-20 03:11:41,429:INFO: Epoch 3/5 Finished, Train Loss: 0.782033
2024-08-20 03:11:41,429:INFO: Eval on val dataset
2024-08-20 03:11:52,537:INFO: sim matrix size: 1000, 1000
2024-08-20 03:11:52,641:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 03:11:52,641:INFO: 	>>>[2109][constrast] Text-to-Video  R@1: 48.6 - R@5: 74.2 - R@10: 83.5 - Median R: 2.0 - Mean R: 13.5
2024-08-20 03:11:52,641:INFO: 	>>> [2109][constrast] V2T$R@1: 47.7 - V2T$R@5: 74.7 - V2T$R@10: 84.0 - V2T$Median R: 2.0 - V2T$Mean R: 9.6
2024-08-20 03:11:53,339:INFO: The best model is: outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth, the R1 is: 47.5000
2024-08-20 03:11:53,517:INFO: Start generating the context prototype set.
2024-08-20 03:11:53,517:INFO: Start generating the context prototype set.
2024-08-20 03:11:53,518:INFO: Start generating the context prototype set.
2024-08-20 03:11:53,519:INFO: Start generating the context prototype set.
2024-08-20 03:12:21,372:INFO: Initializion of the memory banks done.
2024-08-20 03:12:23,113:INFO: Initializion of the memory banks done.
2024-08-20 03:12:23,285:INFO: Initializion of the memory banks done.
2024-08-20 03:12:23,463:INFO: Initializion of the memory banks done.
2024-08-20 03:12:23,516:INFO: Start to do clustering...
2024-08-20 03:12:23,516:INFO: Start to do clustering...
2024-08-20 03:12:23,516:INFO: Start to do clustering...
2024-08-20 03:12:23,516:INFO: Start to do clustering...
2024-08-20 03:12:23,516:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.633379340171814
2024-08-20 03:12:23,517:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.633379340171814
2024-08-20 03:12:23,517:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.633379340171814
2024-08-20 03:12:23,517:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.633379340171814
2024-08-20 03:12:23,520:INFO: [rank=1] centroids: 0.6285030841827393
2024-08-20 03:12:23,520:INFO: [rank=0] centroids: 0.6285030841827393
2024-08-20 03:12:23,720:INFO: [rank=1] centroids: 0.6398135423660278
2024-08-20 03:12:23,721:INFO: [rank=0] centroids: 0.6398135423660278
2024-08-20 03:12:23,931:INFO: [rank=0] centroids: 0.6338344812393188
2024-08-20 03:12:23,931:INFO: [rank=1] centroids: 0.6338344812393188
2024-08-20 03:12:24,126:INFO: [rank=0] centroids: 0.6316519379615784
2024-08-20 03:12:24,126:INFO: [rank=1] centroids: 0.6316519379615784
2024-08-20 03:12:24,320:INFO: [rank=0] centroids: 0.6318641304969788
2024-08-20 03:12:24,320:INFO: [rank=1] centroids: 0.6318641304969788
2024-08-20 03:12:24,514:INFO: [rank=1] centroids: 0.6334053874015808
2024-08-20 03:12:24,514:INFO: [rank=0] centroids: 0.6334053874015808
2024-08-20 03:12:24,709:INFO: [rank=1] centroids: 0.634511411190033
2024-08-20 03:12:24,709:INFO: [rank=0] centroids: 0.634511411190033
2024-08-20 03:12:24,909:INFO: [rank=1] centroids: 0.6349831223487854
2024-08-20 03:12:24,909:INFO: [rank=0] centroids: 0.6349831223487854
2024-08-20 03:12:25,146:INFO: [rank=1] centroids: 0.6354459524154663
2024-08-20 03:12:25,146:INFO: [rank=0] centroids: 0.6354459524154663
2024-08-20 03:12:25,341:INFO: [rank=0] centroids: 0.6355283260345459
2024-08-20 03:12:25,341:INFO: [rank=1] centroids: 0.6355283260345459
2024-08-20 03:12:25,535:INFO: [rank=1] centroids: 0.635479748249054
2024-08-20 03:12:25,535:INFO: [rank=0] centroids: 0.635479748249054
2024-08-20 03:12:25,595:INFO: Clustering done.
2024-08-20 03:12:25,595:INFO: Clustering done.
2024-08-20 03:12:25,596:INFO: Clustering done.
2024-08-20 03:12:25,596:INFO: Context prototype set generated.
2024-08-20 03:12:25,596:INFO: Context prototype set generated.
2024-08-20 03:12:25,597:INFO: Context prototype set generated.
2024-08-20 03:12:25,600:INFO: Clustering done.
2024-08-20 03:12:25,601:INFO: Context prototype set generated.
2024-08-20 03:12:35,455:INFO: {'sim_loss': 0.5331166982650757, 'siou_loss': 0.15249940752983093, 'loss': 0.6093664169311523}
2024-08-20 03:12:35,457:INFO: Epoch: 4/5, Step: 1/703, Lr: 0.000000035-0.000345067-0.000654083, Loss: 0.609366, Time/step: 4.194004
2024-08-20 03:12:36,539:INFO: {'sim_loss': 0.5211081504821777, 'siou_loss': 0.15036073327064514, 'loss': 0.5962885022163391}
2024-08-20 03:12:36,541:INFO: Epoch: 4/5, Step: 2/703, Lr: 0.000000034-0.000344642-0.000653658, Loss: 0.596289, Time/step: 0.108344
2024-08-20 03:12:37,689:INFO: {'sim_loss': 0.7128030061721802, 'siou_loss': 0.15281826257705688, 'loss': 0.7892121076583862}
2024-08-20 03:12:37,691:INFO: Epoch: 4/5, Step: 3/703, Lr: 0.000000034-0.000344217-0.000653233, Loss: 0.789212, Time/step: 0.114979
2024-08-20 03:12:38,736:INFO: {'sim_loss': 0.6252544522285461, 'siou_loss': 0.1524205207824707, 'loss': 0.7014647126197815}
2024-08-20 03:12:38,738:INFO: Epoch: 4/5, Step: 4/703, Lr: 0.000000034-0.000343792-0.000652807, Loss: 0.701465, Time/step: 0.104742
2024-08-20 03:12:46,475:INFO: {'sim_loss': 0.6324658989906311, 'siou_loss': 0.15099304914474487, 'loss': 0.7079623937606812}
2024-08-20 03:12:46,477:INFO: Epoch: 4/5, Step: 11/703, Lr: 0.000000034-0.000340824-0.000649826, Loss: 0.707962, Time/step: 0.773844
2024-08-20 03:12:57,659:INFO: {'sim_loss': 0.49239015579223633, 'siou_loss': 0.15117612481117249, 'loss': 0.5679782032966614}
2024-08-20 03:12:57,663:INFO: Epoch: 4/5, Step: 21/703, Lr: 0.000000034-0.000336594-0.000645557, Loss: 0.567978, Time/step: 1.118563
2024-08-20 03:13:08,739:INFO: {'sim_loss': 0.5848678350448608, 'siou_loss': 0.15115001797676086, 'loss': 0.6604428291320801}
2024-08-20 03:13:08,742:INFO: Epoch: 4/5, Step: 31/703, Lr: 0.000000033-0.000332377-0.000641276, Loss: 0.660443, Time/step: 1.107908
2024-08-20 03:13:19,811:INFO: {'sim_loss': 0.6453835964202881, 'siou_loss': 0.15036988258361816, 'loss': 0.7205685377120972}
2024-08-20 03:13:19,813:INFO: Epoch: 4/5, Step: 41/703, Lr: 0.000000033-0.000328174-0.000636983, Loss: 0.720569, Time/step: 1.107095
2024-08-20 03:13:30,842:INFO: {'sim_loss': 0.5400433540344238, 'siou_loss': 0.14864414930343628, 'loss': 0.6143654584884644}
2024-08-20 03:13:30,844:INFO: Epoch: 4/5, Step: 51/703, Lr: 0.000000032-0.000323984-0.000632680, Loss: 0.614365, Time/step: 1.103102
2024-08-20 03:13:41,798:INFO: {'sim_loss': 0.560291051864624, 'siou_loss': 0.1487630307674408, 'loss': 0.6346725821495056}
2024-08-20 03:13:41,801:INFO: Epoch: 4/5, Step: 61/703, Lr: 0.000000032-0.000319808-0.000628366, Loss: 0.634673, Time/step: 1.095590
2024-08-20 03:13:53,033:INFO: {'sim_loss': 0.6639360785484314, 'siou_loss': 0.15108174085617065, 'loss': 0.7394769191741943}
2024-08-20 03:13:53,035:INFO: Epoch: 4/5, Step: 71/703, Lr: 0.000000032-0.000315647-0.000624042, Loss: 0.739477, Time/step: 1.123405
2024-08-20 03:14:04,167:INFO: {'sim_loss': 0.5026736259460449, 'siou_loss': 0.14830580353736877, 'loss': 0.5768265128135681}
2024-08-20 03:14:04,169:INFO: Epoch: 4/5, Step: 81/703, Lr: 0.000000031-0.000311500-0.000619708, Loss: 0.576827, Time/step: 1.113438
2024-08-20 03:14:15,066:INFO: {'sim_loss': 0.6584203839302063, 'siou_loss': 0.15051570534706116, 'loss': 0.7336782217025757}
2024-08-20 03:14:15,068:INFO: Epoch: 4/5, Step: 91/703, Lr: 0.000000031-0.000307369-0.000615364, Loss: 0.733678, Time/step: 1.089897
2024-08-20 03:14:26,058:INFO: {'sim_loss': 0.6877402067184448, 'siou_loss': 0.14949703216552734, 'loss': 0.7624887228012085}
2024-08-20 03:14:26,060:INFO: Epoch: 4/5, Step: 101/703, Lr: 0.000000030-0.000303253-0.000611011, Loss: 0.762489, Time/step: 1.099195
2024-08-20 03:14:37,099:INFO: {'sim_loss': 0.5846071243286133, 'siou_loss': 0.1480552852153778, 'loss': 0.6586347818374634}
2024-08-20 03:14:37,101:INFO: Epoch: 4/5, Step: 111/703, Lr: 0.000000030-0.000299152-0.000606650, Loss: 0.658635, Time/step: 1.104058
2024-08-20 03:14:47,982:INFO: {'sim_loss': 0.616492748260498, 'siou_loss': 0.14627087116241455, 'loss': 0.6896281838417053}
2024-08-20 03:14:47,984:INFO: Epoch: 4/5, Step: 121/703, Lr: 0.000000030-0.000295068-0.000602280, Loss: 0.689628, Time/step: 1.088278
2024-08-20 03:14:59,040:INFO: {'sim_loss': 0.6645258069038391, 'siou_loss': 0.14664632081985474, 'loss': 0.7378489971160889}
2024-08-20 03:14:59,042:INFO: Epoch: 4/5, Step: 131/703, Lr: 0.000000029-0.000291000-0.000597901, Loss: 0.737849, Time/step: 1.105734
2024-08-20 03:15:09,925:INFO: {'sim_loss': 0.4983201026916504, 'siou_loss': 0.1462101936340332, 'loss': 0.571425199508667}
2024-08-20 03:15:09,928:INFO: Epoch: 4/5, Step: 141/703, Lr: 0.000000029-0.000286949-0.000593515, Loss: 0.571425, Time/step: 1.088570
2024-08-20 03:15:20,856:INFO: {'sim_loss': 0.48748672008514404, 'siou_loss': 0.14595001935958862, 'loss': 0.5604617595672607}
2024-08-20 03:15:20,858:INFO: Epoch: 4/5, Step: 151/703, Lr: 0.000000028-0.000282914-0.000589121, Loss: 0.560462, Time/step: 1.093044
2024-08-20 03:15:31,604:INFO: {'sim_loss': 0.6312817335128784, 'siou_loss': 0.1469365656375885, 'loss': 0.7047500014305115}
2024-08-20 03:15:31,606:INFO: Epoch: 4/5, Step: 161/703, Lr: 0.000000028-0.000278897-0.000584721, Loss: 0.704750, Time/step: 1.074796
2024-08-20 03:15:42,566:INFO: {'sim_loss': 0.5761153697967529, 'siou_loss': 0.14620444178581238, 'loss': 0.6492176055908203}
2024-08-20 03:15:42,568:INFO: Epoch: 4/5, Step: 171/703, Lr: 0.000000027-0.000274898-0.000580313, Loss: 0.649218, Time/step: 1.096188
2024-08-20 03:15:53,530:INFO: {'sim_loss': 0.6412460207939148, 'siou_loss': 0.1450560986995697, 'loss': 0.7137740850448608}
2024-08-20 03:15:53,532:INFO: Epoch: 4/5, Step: 181/703, Lr: 0.000000027-0.000270917-0.000575899, Loss: 0.713774, Time/step: 1.096348
2024-08-20 03:16:04,612:INFO: {'sim_loss': 0.6196215748786926, 'siou_loss': 0.14293792843818665, 'loss': 0.6910905241966248}
2024-08-20 03:16:04,615:INFO: Epoch: 4/5, Step: 191/703, Lr: 0.000000027-0.000266954-0.000571479, Loss: 0.691091, Time/step: 1.108249
2024-08-20 03:16:15,605:INFO: {'sim_loss': 0.5585638284683228, 'siou_loss': 0.1451287865638733, 'loss': 0.631128191947937}
2024-08-20 03:16:15,608:INFO: Epoch: 4/5, Step: 201/703, Lr: 0.000000026-0.000263009-0.000567053, Loss: 0.631128, Time/step: 1.099292
2024-08-20 03:16:26,513:INFO: {'sim_loss': 0.6059360504150391, 'siou_loss': 0.14299815893173218, 'loss': 0.6774351596832275}
2024-08-20 03:16:26,515:INFO: Epoch: 4/5, Step: 211/703, Lr: 0.000000026-0.000259084-0.000562622, Loss: 0.677435, Time/step: 1.090733
2024-08-20 03:16:37,534:INFO: {'sim_loss': 0.5984268188476562, 'siou_loss': 0.1462666392326355, 'loss': 0.6715601682662964}
2024-08-20 03:16:37,537:INFO: Epoch: 4/5, Step: 221/703, Lr: 0.000000026-0.000255178-0.000558186, Loss: 0.671560, Time/step: 1.102118
2024-08-20 03:16:48,416:INFO: {'sim_loss': 0.5788469314575195, 'siou_loss': 0.1441679298877716, 'loss': 0.6509308815002441}
2024-08-20 03:16:48,418:INFO: Epoch: 4/5, Step: 231/703, Lr: 0.000000025-0.000251291-0.000553745, Loss: 0.650931, Time/step: 1.088149
2024-08-20 03:16:59,290:INFO: {'sim_loss': 0.6103839874267578, 'siou_loss': 0.14266014099121094, 'loss': 0.6817140579223633}
2024-08-20 03:16:59,295:INFO: Epoch: 4/5, Step: 241/703, Lr: 0.000000025-0.000247424-0.000549300, Loss: 0.681714, Time/step: 1.087674
2024-08-20 03:17:10,153:INFO: {'sim_loss': 0.697391927242279, 'siou_loss': 0.1450328230857849, 'loss': 0.7699083089828491}
2024-08-20 03:17:10,155:INFO: Epoch: 4/5, Step: 251/703, Lr: 0.000000024-0.000243578-0.000544851, Loss: 0.769908, Time/step: 1.086002
2024-08-20 03:17:21,074:INFO: {'sim_loss': 0.515697717666626, 'siou_loss': 0.1435021162033081, 'loss': 0.58744877576828}
2024-08-20 03:17:21,076:INFO: Epoch: 4/5, Step: 261/703, Lr: 0.000000024-0.000239752-0.000540399, Loss: 0.587449, Time/step: 1.092071
2024-08-20 03:17:32,114:INFO: {'sim_loss': 0.6100268363952637, 'siou_loss': 0.14426273107528687, 'loss': 0.6821582317352295}
2024-08-20 03:17:32,117:INFO: Epoch: 4/5, Step: 271/703, Lr: 0.000000024-0.000235946-0.000535943, Loss: 0.682158, Time/step: 1.104047
2024-08-20 03:17:43,090:INFO: {'sim_loss': 0.5183501243591309, 'siou_loss': 0.14308622479438782, 'loss': 0.5898932218551636}
2024-08-20 03:17:43,093:INFO: Epoch: 4/5, Step: 281/703, Lr: 0.000000023-0.000232162-0.000531484, Loss: 0.589893, Time/step: 1.097558
2024-08-20 03:17:54,079:INFO: {'sim_loss': 0.679706335067749, 'siou_loss': 0.14300832152366638, 'loss': 0.7512105107307434}
2024-08-20 03:17:54,083:INFO: Epoch: 4/5, Step: 291/703, Lr: 0.000000023-0.000228399-0.000527023, Loss: 0.751211, Time/step: 1.098985
2024-08-20 03:18:04,955:INFO: {'sim_loss': 0.580316424369812, 'siou_loss': 0.13983875513076782, 'loss': 0.6502357721328735}
2024-08-20 03:18:04,958:INFO: Epoch: 4/5, Step: 301/703, Lr: 0.000000022-0.000224658-0.000522560, Loss: 0.650236, Time/step: 1.087493
2024-08-20 03:18:15,767:INFO: {'sim_loss': 0.5344838500022888, 'siou_loss': 0.14128097891807556, 'loss': 0.6051243543624878}
2024-08-20 03:18:15,770:INFO: Epoch: 4/5, Step: 311/703, Lr: 0.000000022-0.000220939-0.000518095, Loss: 0.605124, Time/step: 1.081205
2024-08-20 03:18:26,710:INFO: {'sim_loss': 0.6652830839157104, 'siou_loss': 0.1444205939769745, 'loss': 0.7374933958053589}
2024-08-20 03:18:26,713:INFO: Epoch: 4/5, Step: 321/703, Lr: 0.000000022-0.000217242-0.000513628, Loss: 0.737493, Time/step: 1.094235
2024-08-20 03:18:37,656:INFO: {'sim_loss': 0.5994820594787598, 'siou_loss': 0.13983646035194397, 'loss': 0.6694002747535706}
2024-08-20 03:18:37,658:INFO: Epoch: 4/5, Step: 331/703, Lr: 0.000000021-0.000213568-0.000509161, Loss: 0.669400, Time/step: 1.094570
2024-08-20 03:18:48,490:INFO: {'sim_loss': 0.6217809915542603, 'siou_loss': 0.14087456464767456, 'loss': 0.6922183036804199}
2024-08-20 03:18:48,493:INFO: Epoch: 4/5, Step: 341/703, Lr: 0.000000021-0.000209916-0.000504692, Loss: 0.692218, Time/step: 1.083292
2024-08-20 03:18:59,380:INFO: {'sim_loss': 0.5510194897651672, 'siou_loss': 0.1397029459476471, 'loss': 0.6208709478378296}
2024-08-20 03:18:59,382:INFO: Epoch: 4/5, Step: 351/703, Lr: 0.000000021-0.000206288-0.000500223, Loss: 0.620871, Time/step: 1.088905
2024-08-20 03:19:10,324:INFO: {'sim_loss': 0.5456651449203491, 'siou_loss': 0.13939312100410461, 'loss': 0.6153616905212402}
2024-08-20 03:19:10,326:INFO: Epoch: 4/5, Step: 361/703, Lr: 0.000000020-0.000202683-0.000495755, Loss: 0.615362, Time/step: 1.094406
2024-08-20 03:19:21,284:INFO: {'sim_loss': 0.6947659254074097, 'siou_loss': 0.13837659358978271, 'loss': 0.763954222202301}
2024-08-20 03:19:21,286:INFO: Epoch: 4/5, Step: 371/703, Lr: 0.000000020-0.000199102-0.000491286, Loss: 0.763954, Time/step: 1.095990
2024-08-20 03:19:32,415:INFO: {'sim_loss': 0.67195725440979, 'siou_loss': 0.14053025841712952, 'loss': 0.7422223687171936}
2024-08-20 03:19:32,417:INFO: Epoch: 4/5, Step: 381/703, Lr: 0.000000020-0.000195545-0.000486818, Loss: 0.742222, Time/step: 1.113069
2024-08-20 03:19:43,478:INFO: {'sim_loss': 0.657010018825531, 'siou_loss': 0.1421145796775818, 'loss': 0.7280672788619995}
2024-08-20 03:19:43,480:INFO: Epoch: 4/5, Step: 391/703, Lr: 0.000000019-0.000192013-0.000482352, Loss: 0.728067, Time/step: 1.106282
2024-08-20 03:19:54,381:INFO: {'sim_loss': 0.6983121633529663, 'siou_loss': 0.1387041211128235, 'loss': 0.7676641941070557}
2024-08-20 03:19:54,384:INFO: Epoch: 4/5, Step: 401/703, Lr: 0.000000019-0.000188505-0.000477886, Loss: 0.767664, Time/step: 1.090294
2024-08-20 03:20:05,307:INFO: {'sim_loss': 0.609641432762146, 'siou_loss': 0.14164605736732483, 'loss': 0.6804644465446472}
2024-08-20 03:20:05,312:INFO: Epoch: 4/5, Step: 411/703, Lr: 0.000000019-0.000185022-0.000473423, Loss: 0.680464, Time/step: 1.092734
2024-08-20 03:20:16,209:INFO: {'sim_loss': 0.6803985834121704, 'siou_loss': 0.14060816168785095, 'loss': 0.7507026791572571}
2024-08-20 03:20:16,211:INFO: Epoch: 4/5, Step: 421/703, Lr: 0.000000018-0.000181564-0.000468962, Loss: 0.750703, Time/step: 1.089956
2024-08-20 03:20:27,125:INFO: {'sim_loss': 0.5454822778701782, 'siou_loss': 0.14027619361877441, 'loss': 0.6156203746795654}
2024-08-20 03:20:27,128:INFO: Epoch: 4/5, Step: 431/703, Lr: 0.000000018-0.000178131-0.000464503, Loss: 0.615620, Time/step: 1.091625
2024-08-20 03:20:38,196:INFO: {'sim_loss': 0.6525685787200928, 'siou_loss': 0.13558617234230042, 'loss': 0.7203616499900818}
2024-08-20 03:20:38,198:INFO: Epoch: 4/5, Step: 441/703, Lr: 0.000000017-0.000174724-0.000460047, Loss: 0.720362, Time/step: 1.106984
2024-08-20 03:20:48,997:INFO: {'sim_loss': 0.4961833357810974, 'siou_loss': 0.135886549949646, 'loss': 0.5641266107559204}
2024-08-20 03:20:49,016:INFO: Epoch: 4/5, Step: 451/703, Lr: 0.000000017-0.000171343-0.000455594, Loss: 0.564127, Time/step: 1.081775
2024-08-20 03:20:59,938:INFO: {'sim_loss': 0.559037983417511, 'siou_loss': 0.1377500593662262, 'loss': 0.6279129981994629}
2024-08-20 03:20:59,940:INFO: Epoch: 4/5, Step: 461/703, Lr: 0.000000017-0.000167989-0.000451144, Loss: 0.627913, Time/step: 1.092441
2024-08-20 03:21:10,867:INFO: {'sim_loss': 0.574722945690155, 'siou_loss': 0.137212336063385, 'loss': 0.6433291435241699}
2024-08-20 03:21:10,870:INFO: Epoch: 4/5, Step: 471/703, Lr: 0.000000016-0.000164661-0.000446699, Loss: 0.643329, Time/step: 1.092947
2024-08-20 03:21:22,071:INFO: {'sim_loss': 0.5621999502182007, 'siou_loss': 0.1370614767074585, 'loss': 0.6307306885719299}
2024-08-20 03:21:22,073:INFO: Epoch: 4/5, Step: 481/703, Lr: 0.000000016-0.000161359-0.000442258, Loss: 0.630731, Time/step: 1.120309
2024-08-20 03:21:32,876:INFO: {'sim_loss': 0.6114404797554016, 'siou_loss': 0.13753747940063477, 'loss': 0.680209219455719}
2024-08-20 03:21:32,878:INFO: Epoch: 4/5, Step: 491/703, Lr: 0.000000016-0.000158085-0.000437821, Loss: 0.680209, Time/step: 1.080485
2024-08-20 03:21:43,750:INFO: {'sim_loss': 0.6574900150299072, 'siou_loss': 0.13644814491271973, 'loss': 0.7257140874862671}
2024-08-20 03:21:43,752:INFO: Epoch: 4/5, Step: 501/703, Lr: 0.000000015-0.000154838-0.000433390, Loss: 0.725714, Time/step: 1.087409
2024-08-20 03:21:54,616:INFO: {'sim_loss': 0.5797366499900818, 'siou_loss': 0.1342771351337433, 'loss': 0.6468752026557922}
2024-08-20 03:21:54,619:INFO: Epoch: 4/5, Step: 511/703, Lr: 0.000000015-0.000151619-0.000428963, Loss: 0.646875, Time/step: 1.086632
2024-08-20 03:22:05,633:INFO: {'sim_loss': 0.6573975682258606, 'siou_loss': 0.13616853952407837, 'loss': 0.7254818677902222}
2024-08-20 03:22:05,635:INFO: Epoch: 4/5, Step: 521/703, Lr: 0.000000015-0.000148427-0.000424543, Loss: 0.725482, Time/step: 1.101636
2024-08-20 03:22:16,478:INFO: {'sim_loss': 0.655987560749054, 'siou_loss': 0.13829731941223145, 'loss': 0.7251362204551697}
2024-08-20 03:22:16,481:INFO: Epoch: 4/5, Step: 531/703, Lr: 0.000000015-0.000145264-0.000420128, Loss: 0.725136, Time/step: 1.084512
2024-08-20 03:22:27,348:INFO: {'sim_loss': 0.597212016582489, 'siou_loss': 0.13581693172454834, 'loss': 0.6651204824447632}
2024-08-20 03:22:27,350:INFO: Epoch: 4/5, Step: 541/703, Lr: 0.000000014-0.000142128-0.000415720, Loss: 0.665120, Time/step: 1.086972
2024-08-20 03:22:38,258:INFO: {'sim_loss': 0.6676579713821411, 'siou_loss': 0.1359194815158844, 'loss': 0.7356176972389221}
2024-08-20 03:22:38,261:INFO: Epoch: 4/5, Step: 551/703, Lr: 0.000000014-0.000139022-0.000411318, Loss: 0.735618, Time/step: 1.091002
2024-08-20 03:22:49,218:INFO: {'sim_loss': 0.5792043209075928, 'siou_loss': 0.13893595337867737, 'loss': 0.6486722826957703}
2024-08-20 03:22:49,220:INFO: Epoch: 4/5, Step: 561/703, Lr: 0.000000014-0.000135944-0.000406924, Loss: 0.648672, Time/step: 1.095931
2024-08-20 03:23:00,110:INFO: {'sim_loss': 0.6698715686798096, 'siou_loss': 0.13669228553771973, 'loss': 0.7382177114486694}
2024-08-20 03:23:00,112:INFO: Epoch: 4/5, Step: 571/703, Lr: 0.000000013-0.000132896-0.000402537, Loss: 0.738218, Time/step: 1.089201
2024-08-20 03:23:10,968:INFO: {'sim_loss': 0.5507583618164062, 'siou_loss': 0.13444671034812927, 'loss': 0.6179817318916321}
2024-08-20 03:23:10,971:INFO: Epoch: 4/5, Step: 581/703, Lr: 0.000000013-0.000129876-0.000398158, Loss: 0.617982, Time/step: 1.085846
2024-08-20 03:23:21,830:INFO: {'sim_loss': 0.6422806978225708, 'siou_loss': 0.13674485683441162, 'loss': 0.7106531262397766}
2024-08-20 03:23:21,832:INFO: Epoch: 4/5, Step: 591/703, Lr: 0.000000013-0.000126887-0.000393787, Loss: 0.710653, Time/step: 1.086085
2024-08-20 03:23:32,783:INFO: {'sim_loss': 0.5559656620025635, 'siou_loss': 0.1344107985496521, 'loss': 0.6231710910797119}
2024-08-20 03:23:32,786:INFO: Epoch: 4/5, Step: 601/703, Lr: 0.000000012-0.000123927-0.000389424, Loss: 0.623171, Time/step: 1.095403
2024-08-20 03:23:43,802:INFO: {'sim_loss': 0.5036264061927795, 'siou_loss': 0.12923821806907654, 'loss': 0.568245530128479}
2024-08-20 03:23:43,804:INFO: Epoch: 4/5, Step: 611/703, Lr: 0.000000012-0.000120997-0.000385071, Loss: 0.568246, Time/step: 1.101817
2024-08-20 03:23:54,799:INFO: {'sim_loss': 0.7814701795578003, 'siou_loss': 0.1303500533103943, 'loss': 0.8466452360153198}
2024-08-20 03:23:54,802:INFO: Epoch: 4/5, Step: 621/703, Lr: 0.000000012-0.000118097-0.000380726, Loss: 0.846645, Time/step: 1.099707
2024-08-20 03:24:05,754:INFO: {'sim_loss': 0.6271088123321533, 'siou_loss': 0.1317373514175415, 'loss': 0.6929774880409241}
2024-08-20 03:24:05,756:INFO: Epoch: 4/5, Step: 631/703, Lr: 0.000000012-0.000115228-0.000376391, Loss: 0.692977, Time/step: 1.095419
2024-08-20 03:24:16,704:INFO: {'sim_loss': 0.7267552614212036, 'siou_loss': 0.1326937973499298, 'loss': 0.7931021451950073}
2024-08-20 03:24:16,706:INFO: Epoch: 4/5, Step: 641/703, Lr: 0.000000011-0.000112390-0.000372066, Loss: 0.793102, Time/step: 1.094992
2024-08-20 03:24:27,846:INFO: {'sim_loss': 0.48720115423202515, 'siou_loss': 0.12891414761543274, 'loss': 0.5516582131385803}
2024-08-20 03:24:27,848:INFO: Epoch: 4/5, Step: 651/703, Lr: 0.000000011-0.000109582-0.000367751, Loss: 0.551658, Time/step: 1.114212
2024-08-20 03:24:38,637:INFO: {'sim_loss': 0.710908055305481, 'siou_loss': 0.13254371285438538, 'loss': 0.7771798968315125}
2024-08-20 03:24:38,639:INFO: Epoch: 4/5, Step: 661/703, Lr: 0.000000011-0.000106806-0.000363447, Loss: 0.777180, Time/step: 1.079056
2024-08-20 03:24:49,681:INFO: {'sim_loss': 0.6264212727546692, 'siou_loss': 0.13033601641654968, 'loss': 0.6915892958641052}
2024-08-20 03:24:49,684:INFO: Epoch: 4/5, Step: 671/703, Lr: 0.000000010-0.000104061-0.000359153, Loss: 0.691589, Time/step: 1.104463
2024-08-20 03:25:00,549:INFO: {'sim_loss': 0.6321339011192322, 'siou_loss': 0.1341656744480133, 'loss': 0.6992167234420776}
2024-08-20 03:25:00,551:INFO: Epoch: 4/5, Step: 681/703, Lr: 0.000000010-0.000101348-0.000354871, Loss: 0.699217, Time/step: 1.086751
2024-08-20 03:25:11,400:INFO: {'sim_loss': 0.7503335475921631, 'siou_loss': 0.13465207815170288, 'loss': 0.8176596164703369}
2024-08-20 03:25:11,402:INFO: Epoch: 4/5, Step: 691/703, Lr: 0.000000010-0.000098667-0.000350600, Loss: 0.817660, Time/step: 1.084996
2024-08-20 03:25:21,381:INFO: {'sim_loss': 0.6922464966773987, 'siou_loss': 0.13356736302375793, 'loss': 0.7590301632881165}
2024-08-20 03:25:21,382:INFO: Epoch: 4/5, Step: 701/703, Lr: 0.000000010-0.000096017-0.000346342, Loss: 0.759030, Time/step: 0.998014
2024-08-20 03:25:23,768:INFO: Eval on val dataset
2024-08-20 03:25:23,769:INFO: Epoch 4/5 Finished, Train Loss: 0.666543
2024-08-20 03:25:23,769:INFO: Eval on val dataset
2024-08-20 03:25:35,319:INFO: sim matrix size: 1000, 1000
2024-08-20 03:25:35,420:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 03:25:35,420:INFO: 	>>>[2812][constrast] Text-to-Video  R@1: 47.8 - R@5: 74.4 - R@10: 83.3 - Median R: 2.0 - Mean R: 13.5
2024-08-20 03:25:35,420:INFO: 	>>> [2812][constrast] V2T$R@1: 47.1 - V2T$R@5: 74.4 - V2T$R@10: 82.6 - V2T$Median R: 2.0 - V2T$Mean R: 9.6
2024-08-20 03:25:36,102:INFO: The best model is: outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth, the R1 is: 47.8000
2024-08-20 03:25:36,212:INFO: Start generating the context prototype set.
2024-08-20 03:25:36,214:INFO: Start generating the context prototype set.
2024-08-20 03:25:36,214:INFO: Start generating the context prototype set.
2024-08-20 03:25:36,214:INFO: Start generating the context prototype set.
2024-08-20 03:26:07,091:INFO: Initializion of the memory banks done.
2024-08-20 03:26:07,097:INFO: Initializion of the memory banks done.
2024-08-20 03:26:07,432:INFO: Initializion of the memory banks done.
2024-08-20 03:26:07,434:INFO: Initializion of the memory banks done.
2024-08-20 03:26:07,486:INFO: Start to do clustering...
2024-08-20 03:26:07,486:INFO: Start to do clustering...
2024-08-20 03:26:07,486:INFO: Start to do clustering...
2024-08-20 03:26:07,486:INFO: Start to do clustering...
2024-08-20 03:26:07,487:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6290905475616455
2024-08-20 03:26:07,487:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6290905475616455
2024-08-20 03:26:07,487:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6290905475616455
2024-08-20 03:26:07,487:INFO: local_memory_embeddings: torch.Size([215040, 512]), 0.6290905475616455
2024-08-20 03:26:07,489:INFO: [rank=0] centroids: 0.6204755306243896
2024-08-20 03:26:07,489:INFO: [rank=1] centroids: 0.6204755306243896
2024-08-20 03:26:07,686:INFO: [rank=0] centroids: 0.6357896327972412
2024-08-20 03:26:07,686:INFO: [rank=1] centroids: 0.6357896327972412
2024-08-20 03:26:07,882:INFO: [rank=0] centroids: 0.6274228096008301
2024-08-20 03:26:07,882:INFO: [rank=1] centroids: 0.6274228096008301
2024-08-20 03:26:08,078:INFO: [rank=0] centroids: 0.6257880926132202
2024-08-20 03:26:08,078:INFO: [rank=1] centroids: 0.6257880926132202
2024-08-20 03:26:08,270:INFO: [rank=1] centroids: 0.6269544959068298
2024-08-20 03:26:08,270:INFO: [rank=0] centroids: 0.6269544959068298
2024-08-20 03:26:08,468:INFO: [rank=0] centroids: 0.628738522529602
2024-08-20 03:26:08,468:INFO: [rank=1] centroids: 0.628738522529602
2024-08-20 03:26:08,665:INFO: [rank=0] centroids: 0.6292123198509216
2024-08-20 03:26:08,665:INFO: [rank=1] centroids: 0.6292123198509216
2024-08-20 03:26:08,857:INFO: [rank=0] centroids: 0.6293808221817017
2024-08-20 03:26:08,857:INFO: [rank=1] centroids: 0.6293808221817017
2024-08-20 03:26:09,053:INFO: [rank=0] centroids: 0.6294286251068115
2024-08-20 03:26:09,053:INFO: [rank=1] centroids: 0.6294286251068115
2024-08-20 03:26:09,248:INFO: [rank=1] centroids: 0.6300495266914368
2024-08-20 03:26:09,248:INFO: [rank=0] centroids: 0.6300495266914368
2024-08-20 03:26:09,445:INFO: [rank=0] centroids: 0.6304962635040283
2024-08-20 03:26:09,445:INFO: [rank=1] centroids: 0.6304962635040283
2024-08-20 03:26:09,505:INFO: Clustering done.
2024-08-20 03:26:09,506:INFO: Clustering done.
2024-08-20 03:26:09,507:INFO: Context prototype set generated.
2024-08-20 03:26:09,507:INFO: Context prototype set generated.
2024-08-20 03:26:09,508:INFO: Clustering done.
2024-08-20 03:26:09,509:INFO: Clustering done.
2024-08-20 03:26:09,509:INFO: Context prototype set generated.
2024-08-20 03:26:09,510:INFO: Context prototype set generated.
2024-08-20 03:26:22,665:INFO: {'sim_loss': 0.5034050941467285, 'siou_loss': 0.13810980319976807, 'loss': 0.5724599957466125}
2024-08-20 03:26:22,668:INFO: Epoch: 5/5, Step: 1/703, Lr: 0.000000010-0.000095229-0.000345067, Loss: 0.572460, Time/step: 4.645538
2024-08-20 03:26:23,890:INFO: {'sim_loss': 0.40548083186149597, 'siou_loss': 0.14006614685058594, 'loss': 0.47551390528678894}
2024-08-20 03:26:23,893:INFO: Epoch: 5/5, Step: 2/703, Lr: 0.000000009-0.000094967-0.000344642, Loss: 0.475514, Time/step: 0.122470
2024-08-20 03:26:25,114:INFO: {'sim_loss': 0.5197064876556396, 'siou_loss': 0.141668438911438, 'loss': 0.5905407071113586}
2024-08-20 03:26:25,117:INFO: Epoch: 5/5, Step: 3/703, Lr: 0.000000009-0.000094705-0.000344217, Loss: 0.590541, Time/step: 0.122384
2024-08-20 03:26:26,408:INFO: {'sim_loss': 0.5980594754219055, 'siou_loss': 0.14202025532722473, 'loss': 0.6690695881843567}
2024-08-20 03:26:26,411:INFO: Epoch: 5/5, Step: 4/703, Lr: 0.000000009-0.000094443-0.000343792, Loss: 0.669070, Time/step: 0.129369
2024-08-20 03:26:31,361:INFO: {'sim_loss': 0.38418102264404297, 'siou_loss': 0.1417417824268341, 'loss': 0.45505189895629883}
2024-08-20 03:26:31,368:INFO: Epoch: 5/5, Step: 8/703, Lr: 0.000000009-0.000093400-0.000342095, Loss: 0.455052, Time/step: 0.495692
2024-08-20 03:26:42,789:INFO: {'sim_loss': 0.6359001398086548, 'siou_loss': 0.14110302925109863, 'loss': 0.7064516544342041}
2024-08-20 03:26:42,791:INFO: Epoch: 5/5, Step: 18/703, Lr: 0.000000009-0.000090816-0.000337862, Loss: 0.706452, Time/step: 1.142141
2024-08-20 03:26:54,223:INFO: {'sim_loss': 0.5864304900169373, 'siou_loss': 0.14033350348472595, 'loss': 0.6565972566604614}
2024-08-20 03:26:54,226:INFO: Epoch: 5/5, Step: 28/703, Lr: 0.000000009-0.000088264-0.000333641, Loss: 0.656597, Time/step: 1.143456
2024-08-20 03:27:05,827:INFO: {'sim_loss': 0.48827803134918213, 'siou_loss': 0.14565449953079224, 'loss': 0.5611052513122559}
2024-08-20 03:27:05,830:INFO: Epoch: 5/5, Step: 38/703, Lr: 0.000000009-0.000085745-0.000329433, Loss: 0.561105, Time/step: 1.160370
2024-08-20 03:27:17,099:INFO: {'sim_loss': 0.5206584930419922, 'siou_loss': 0.14268341660499573, 'loss': 0.5920001864433289}
2024-08-20 03:27:17,102:INFO: Epoch: 5/5, Step: 48/703, Lr: 0.000000008-0.000083259-0.000325239, Loss: 0.592000, Time/step: 1.127233
2024-08-20 03:27:28,102:INFO: {'sim_loss': 0.6067723035812378, 'siou_loss': 0.13912469148635864, 'loss': 0.6763346195220947}
2024-08-20 03:27:28,104:INFO: Epoch: 5/5, Step: 58/703, Lr: 0.000000008-0.000080807-0.000321059, Loss: 0.676335, Time/step: 1.100210
2024-08-20 03:27:38,965:INFO: {'sim_loss': 0.513422966003418, 'siou_loss': 0.13897550106048584, 'loss': 0.5829107165336609}
2024-08-20 03:27:38,969:INFO: Epoch: 5/5, Step: 68/703, Lr: 0.000000008-0.000078388-0.000316894, Loss: 0.582911, Time/step: 1.086441
2024-08-20 03:27:49,945:INFO: {'sim_loss': 0.5511841773986816, 'siou_loss': 0.14045929908752441, 'loss': 0.6214138269424438}
2024-08-20 03:27:49,947:INFO: Epoch: 5/5, Step: 78/703, Lr: 0.000000008-0.000076002-0.000312743, Loss: 0.621414, Time/step: 1.097802
2024-08-20 03:28:00,984:INFO: {'sim_loss': 0.49108996987342834, 'siou_loss': 0.14059898257255554, 'loss': 0.5613894462585449}
2024-08-20 03:28:00,986:INFO: Epoch: 5/5, Step: 88/703, Lr: 0.000000007-0.000073651-0.000308607, Loss: 0.561389, Time/step: 1.103910
2024-08-20 03:28:11,951:INFO: {'sim_loss': 0.5444436073303223, 'siou_loss': 0.13819757103919983, 'loss': 0.613542377948761}
2024-08-20 03:28:11,954:INFO: Epoch: 5/5, Step: 98/703, Lr: 0.000000007-0.000071333-0.000304486, Loss: 0.613542, Time/step: 1.096726
2024-08-20 03:28:23,183:INFO: {'sim_loss': 0.6725084781646729, 'siou_loss': 0.13928011059761047, 'loss': 0.7421485185623169}
2024-08-20 03:28:23,186:INFO: Epoch: 5/5, Step: 108/703, Lr: 0.000000007-0.000069050-0.000300381, Loss: 0.742149, Time/step: 1.123179
2024-08-20 03:28:34,299:INFO: {'sim_loss': 0.417508602142334, 'siou_loss': 0.13935986161231995, 'loss': 0.48718851804733276}
2024-08-20 03:28:34,301:INFO: Epoch: 5/5, Step: 118/703, Lr: 0.000000007-0.000066801-0.000296292, Loss: 0.487189, Time/step: 1.111490
2024-08-20 03:28:45,295:INFO: {'sim_loss': 0.4758074879646301, 'siou_loss': 0.13864043354988098, 'loss': 0.5451276898384094}
2024-08-20 03:28:45,297:INFO: Epoch: 5/5, Step: 128/703, Lr: 0.000000006-0.000064587-0.000292219, Loss: 0.545128, Time/step: 1.099586
2024-08-20 03:28:56,422:INFO: {'sim_loss': 0.44668787717819214, 'siou_loss': 0.13519605994224548, 'loss': 0.5142859220504761}
2024-08-20 03:28:56,424:INFO: Epoch: 5/5, Step: 138/703, Lr: 0.000000006-0.000062408-0.000288162, Loss: 0.514286, Time/step: 1.112662
2024-08-20 03:29:07,323:INFO: {'sim_loss': 0.6541101932525635, 'siou_loss': 0.1392304003238678, 'loss': 0.7237253785133362}
2024-08-20 03:29:07,325:INFO: Epoch: 5/5, Step: 148/703, Lr: 0.000000006-0.000060263-0.000284123, Loss: 0.723725, Time/step: 1.090091
2024-08-20 03:29:18,352:INFO: {'sim_loss': 0.649262547492981, 'siou_loss': 0.13963329792022705, 'loss': 0.7190791964530945}
2024-08-20 03:29:18,355:INFO: Epoch: 5/5, Step: 158/703, Lr: 0.000000006-0.000058154-0.000280101, Loss: 0.719079, Time/step: 1.102932
2024-08-20 03:29:29,376:INFO: {'sim_loss': 0.5529347658157349, 'siou_loss': 0.13401934504508972, 'loss': 0.6199444532394409}
2024-08-20 03:29:29,397:INFO: Epoch: 5/5, Step: 168/703, Lr: 0.000000006-0.000056080-0.000276096, Loss: 0.619944, Time/step: 1.104172
2024-08-20 03:29:40,292:INFO: {'sim_loss': 0.5307494401931763, 'siou_loss': 0.13743796944618225, 'loss': 0.5994684100151062}
2024-08-20 03:29:40,295:INFO: Epoch: 5/5, Step: 178/703, Lr: 0.000000005-0.000054041-0.000272109, Loss: 0.599468, Time/step: 1.089836
2024-08-20 03:29:51,277:INFO: {'sim_loss': 0.5329604744911194, 'siou_loss': 0.13519492745399475, 'loss': 0.6005579233169556}
2024-08-20 03:29:51,280:INFO: Epoch: 5/5, Step: 188/703, Lr: 0.000000005-0.000052038-0.000268141, Loss: 0.600558, Time/step: 1.098471
2024-08-20 03:30:02,161:INFO: {'sim_loss': 0.4655541181564331, 'siou_loss': 0.13370883464813232, 'loss': 0.5324085354804993}
2024-08-20 03:30:02,164:INFO: Epoch: 5/5, Step: 198/703, Lr: 0.000000005-0.000050071-0.000264191, Loss: 0.532409, Time/step: 1.088343
2024-08-20 03:30:13,055:INFO: {'sim_loss': 0.45050278306007385, 'siou_loss': 0.1349245011806488, 'loss': 0.5179650187492371}
2024-08-20 03:30:13,057:INFO: Epoch: 5/5, Step: 208/703, Lr: 0.000000005-0.000048140-0.000260260, Loss: 0.517965, Time/step: 1.089350
2024-08-20 03:30:23,979:INFO: {'sim_loss': 0.6417726874351501, 'siou_loss': 0.13452568650245667, 'loss': 0.7090355157852173}
2024-08-20 03:30:23,982:INFO: Epoch: 5/5, Step: 218/703, Lr: 0.000000005-0.000046245-0.000256348, Loss: 0.709036, Time/step: 1.092387
2024-08-20 03:30:35,253:INFO: {'sim_loss': 0.5711617469787598, 'siou_loss': 0.1374916136264801, 'loss': 0.6399075388908386}
2024-08-20 03:30:35,257:INFO: Epoch: 5/5, Step: 228/703, Lr: 0.000000004-0.000044386-0.000252455, Loss: 0.639908, Time/step: 1.127497
2024-08-20 03:30:46,187:INFO: {'sim_loss': 0.4524160623550415, 'siou_loss': 0.13538259267807007, 'loss': 0.5201073884963989}
2024-08-20 03:30:46,189:INFO: Epoch: 5/5, Step: 238/703, Lr: 0.000000004-0.000042563-0.000248582, Loss: 0.520107, Time/step: 1.093246
2024-08-20 03:30:57,109:INFO: {'sim_loss': 0.5362539291381836, 'siou_loss': 0.1383245289325714, 'loss': 0.6054161787033081}
2024-08-20 03:30:57,111:INFO: Epoch: 5/5, Step: 248/703, Lr: 0.000000004-0.000040777-0.000244730, Loss: 0.605416, Time/step: 1.092205
2024-08-20 03:31:08,165:INFO: {'sim_loss': 0.5666357278823853, 'siou_loss': 0.13616347312927246, 'loss': 0.6347174644470215}
2024-08-20 03:31:08,168:INFO: Epoch: 5/5, Step: 258/703, Lr: 0.000000004-0.000039028-0.000240897, Loss: 0.634717, Time/step: 1.105597
2024-08-20 03:31:19,354:INFO: {'sim_loss': 0.5610164403915405, 'siou_loss': 0.13747546076774597, 'loss': 0.6297541856765747}
2024-08-20 03:31:19,357:INFO: Epoch: 5/5, Step: 268/703, Lr: 0.000000004-0.000037316-0.000237086, Loss: 0.629754, Time/step: 1.118884
2024-08-20 03:31:30,315:INFO: {'sim_loss': 0.4928591549396515, 'siou_loss': 0.1343688666820526, 'loss': 0.5600435733795166}
2024-08-20 03:31:30,319:INFO: Epoch: 5/5, Step: 278/703, Lr: 0.000000004-0.000035640-0.000233295, Loss: 0.560044, Time/step: 1.096195
2024-08-20 03:31:41,322:INFO: {'sim_loss': 0.680678129196167, 'siou_loss': 0.13623255491256714, 'loss': 0.748794436454773}
2024-08-20 03:31:41,324:INFO: Epoch: 5/5, Step: 288/703, Lr: 0.000000003-0.000034002-0.000229526, Loss: 0.748794, Time/step: 1.100509
2024-08-20 03:31:52,288:INFO: {'sim_loss': 0.4679165482521057, 'siou_loss': 0.13547533750534058, 'loss': 0.5356541872024536}
2024-08-20 03:31:52,290:INFO: Epoch: 5/5, Step: 298/703, Lr: 0.000000003-0.000032401-0.000225778, Loss: 0.535654, Time/step: 1.096613
2024-08-20 03:32:03,279:INFO: {'sim_loss': 0.482649028301239, 'siou_loss': 0.13523179292678833, 'loss': 0.5502649545669556}
2024-08-20 03:32:03,281:INFO: Epoch: 5/5, Step: 308/703, Lr: 0.000000003-0.000030837-0.000222052, Loss: 0.550265, Time/step: 1.099073
2024-08-20 03:32:14,118:INFO: {'sim_loss': 0.5506108999252319, 'siou_loss': 0.13669314980506897, 'loss': 0.6189574599266052}
2024-08-20 03:32:14,120:INFO: Epoch: 5/5, Step: 318/703, Lr: 0.000000003-0.000029310-0.000218349, Loss: 0.618957, Time/step: 1.083856
2024-08-20 03:32:25,063:INFO: {'sim_loss': 0.6103203296661377, 'siou_loss': 0.13629859685897827, 'loss': 0.6784696578979492}
2024-08-20 03:32:25,067:INFO: Epoch: 5/5, Step: 328/703, Lr: 0.000000003-0.000027822-0.000214668, Loss: 0.678470, Time/step: 1.094653
2024-08-20 03:32:36,087:INFO: {'sim_loss': 0.576137900352478, 'siou_loss': 0.13791018724441528, 'loss': 0.6450929641723633}
2024-08-20 03:32:36,091:INFO: Epoch: 5/5, Step: 338/703, Lr: 0.000000003-0.000026371-0.000211009, Loss: 0.645093, Time/step: 1.102388
2024-08-20 03:32:46,893:INFO: {'sim_loss': 0.6707800626754761, 'siou_loss': 0.1364639699459076, 'loss': 0.7390120625495911}
2024-08-20 03:32:46,896:INFO: Epoch: 5/5, Step: 348/703, Lr: 0.000000002-0.000024957-0.000207374, Loss: 0.739012, Time/step: 1.080475
2024-08-20 03:32:57,869:INFO: {'sim_loss': 0.5118007063865662, 'siou_loss': 0.1364191472530365, 'loss': 0.5800102949142456}
2024-08-20 03:32:57,871:INFO: Epoch: 5/5, Step: 358/703, Lr: 0.000000002-0.000023582-0.000203762, Loss: 0.580010, Time/step: 1.097553
2024-08-20 03:33:08,827:INFO: {'sim_loss': 0.4707190692424774, 'siou_loss': 0.1370922327041626, 'loss': 0.5392651557922363}
2024-08-20 03:33:08,830:INFO: Epoch: 5/5, Step: 368/703, Lr: 0.000000002-0.000022245-0.000200174, Loss: 0.539265, Time/step: 1.095870
2024-08-20 03:33:19,865:INFO: {'sim_loss': 0.36598002910614014, 'siou_loss': 0.1354522705078125, 'loss': 0.4337061643600464}
2024-08-20 03:33:19,867:INFO: Epoch: 5/5, Step: 378/703, Lr: 0.000000002-0.000020946-0.000196610, Loss: 0.433706, Time/step: 1.103680
2024-08-20 03:33:30,926:INFO: {'sim_loss': 0.5463908910751343, 'siou_loss': 0.1358984112739563, 'loss': 0.61434006690979}
2024-08-20 03:33:30,936:INFO: Epoch: 5/5, Step: 388/703, Lr: 0.000000002-0.000019685-0.000193070, Loss: 0.614340, Time/step: 1.106862
2024-08-20 03:33:41,923:INFO: {'sim_loss': 0.45911628007888794, 'siou_loss': 0.13684386014938354, 'loss': 0.5275381803512573}
2024-08-20 03:33:41,926:INFO: Epoch: 5/5, Step: 398/703, Lr: 0.000000002-0.000018463-0.000189555, Loss: 0.527538, Time/step: 1.098964
2024-08-20 03:33:52,747:INFO: {'sim_loss': 0.45831456780433655, 'siou_loss': 0.134636789560318, 'loss': 0.5256329774856567}
2024-08-20 03:33:52,749:INFO: Epoch: 5/5, Step: 408/703, Lr: 0.000000002-0.000017279-0.000186064, Loss: 0.525633, Time/step: 1.082362
2024-08-20 03:34:03,682:INFO: {'sim_loss': 0.5004227161407471, 'siou_loss': 0.13472113013267517, 'loss': 0.5677832961082458}
2024-08-20 03:34:03,684:INFO: Epoch: 5/5, Step: 418/703, Lr: 0.000000002-0.000016134-0.000182598, Loss: 0.567783, Time/step: 1.093427
2024-08-20 03:34:14,639:INFO: {'sim_loss': 0.5558760166168213, 'siou_loss': 0.14079385995864868, 'loss': 0.6262729167938232}
2024-08-20 03:34:14,642:INFO: Epoch: 5/5, Step: 428/703, Lr: 0.000000002-0.000015027-0.000179158, Loss: 0.626273, Time/step: 1.095752
2024-08-20 03:34:25,603:INFO: {'sim_loss': 0.5676187872886658, 'siou_loss': 0.1345037817955017, 'loss': 0.6348706483840942}
2024-08-20 03:34:25,606:INFO: Epoch: 5/5, Step: 438/703, Lr: 0.000000001-0.000013959-0.000175743, Loss: 0.634871, Time/step: 1.096431
2024-08-20 03:34:36,674:INFO: {'sim_loss': 0.555937647819519, 'siou_loss': 0.13735046982765198, 'loss': 0.6246128678321838}
2024-08-20 03:34:36,676:INFO: Epoch: 5/5, Step: 448/703, Lr: 0.000000001-0.000012930-0.000172355, Loss: 0.624613, Time/step: 1.106995
2024-08-20 03:34:47,697:INFO: {'sim_loss': 0.49037787318229675, 'siou_loss': 0.13255566358566284, 'loss': 0.5566557049751282}
2024-08-20 03:34:47,700:INFO: Epoch: 5/5, Step: 458/703, Lr: 0.000000001-0.000011939-0.000168992, Loss: 0.556656, Time/step: 1.102335
2024-08-20 03:34:58,672:INFO: {'sim_loss': 0.5727429389953613, 'siou_loss': 0.1354874074459076, 'loss': 0.6404866576194763}
2024-08-20 03:34:58,674:INFO: Epoch: 5/5, Step: 468/703, Lr: 0.000000001-0.000010988-0.000165656, Loss: 0.640487, Time/step: 1.097408
2024-08-20 03:35:09,586:INFO: {'sim_loss': 0.7498000264167786, 'siou_loss': 0.13921236991882324, 'loss': 0.8194062113761902}
2024-08-20 03:35:09,588:INFO: Epoch: 5/5, Step: 478/703, Lr: 0.000000001-0.000010076-0.000162347, Loss: 0.819406, Time/step: 1.091437
2024-08-20 03:35:20,269:INFO: {'sim_loss': 0.46314847469329834, 'siou_loss': 0.1337791085243225, 'loss': 0.5300379991531372}
2024-08-20 03:35:20,271:INFO: Epoch: 5/5, Step: 488/703, Lr: 0.000000001-0.000009203-0.000159064, Loss: 0.530038, Time/step: 1.068220
2024-08-20 03:35:31,265:INFO: {'sim_loss': 0.5487698912620544, 'siou_loss': 0.13358446955680847, 'loss': 0.6155621409416199}
2024-08-20 03:35:31,267:INFO: Epoch: 5/5, Step: 498/703, Lr: 0.000000001-0.000008369-0.000155809, Loss: 0.615562, Time/step: 1.099644
2024-08-20 03:35:42,188:INFO: {'sim_loss': 0.6098686456680298, 'siou_loss': 0.13582885265350342, 'loss': 0.6777830719947815}
2024-08-20 03:35:42,190:INFO: Epoch: 5/5, Step: 508/703, Lr: 0.000000001-0.000007575-0.000152582, Loss: 0.677783, Time/step: 1.092283
2024-08-20 03:35:53,025:INFO: {'sim_loss': 0.4782974123954773, 'siou_loss': 0.1341804563999176, 'loss': 0.5453876256942749}
2024-08-20 03:35:53,027:INFO: Epoch: 5/5, Step: 518/703, Lr: 0.000000001-0.000006819-0.000149382, Loss: 0.545388, Time/step: 1.083682
2024-08-20 03:36:03,951:INFO: {'sim_loss': 0.5274919271469116, 'siou_loss': 0.13241440057754517, 'loss': 0.5936990976333618}
2024-08-20 03:36:03,953:INFO: Epoch: 5/5, Step: 528/703, Lr: 0.000000001-0.000006104-0.000146210, Loss: 0.593699, Time/step: 1.092573
2024-08-20 03:36:15,038:INFO: {'sim_loss': 0.5393840074539185, 'siou_loss': 0.13573062419891357, 'loss': 0.6072493195533752}
2024-08-20 03:36:15,041:INFO: Epoch: 5/5, Step: 538/703, Lr: 0.000000001-0.000005427-0.000143066, Loss: 0.607249, Time/step: 1.108755
2024-08-20 03:36:26,101:INFO: {'sim_loss': 0.5962848663330078, 'siou_loss': 0.13673871755599976, 'loss': 0.6646542549133301}
2024-08-20 03:36:26,103:INFO: Epoch: 5/5, Step: 548/703, Lr: 0.000000000-0.000004790-0.000139951, Loss: 0.664654, Time/step: 1.106202
2024-08-20 03:36:36,951:INFO: {'sim_loss': 0.46659719944000244, 'siou_loss': 0.1313837170600891, 'loss': 0.5322890281677246}
2024-08-20 03:36:36,954:INFO: Epoch: 5/5, Step: 558/703, Lr: 0.000000000-0.000004193-0.000136865, Loss: 0.532289, Time/step: 1.085036
2024-08-20 03:36:47,964:INFO: {'sim_loss': 0.6681244373321533, 'siou_loss': 0.13460150361061096, 'loss': 0.7354251742362976}
2024-08-20 03:36:47,968:INFO: Epoch: 5/5, Step: 568/703, Lr: 0.000000000-0.000003635-0.000133807, Loss: 0.735425, Time/step: 1.101422
2024-08-20 03:36:59,124:INFO: {'sim_loss': 0.5682320594787598, 'siou_loss': 0.13516494631767273, 'loss': 0.6358145475387573}
2024-08-20 03:36:59,126:INFO: Epoch: 5/5, Step: 578/703, Lr: 0.000000000-0.000003117-0.000130779, Loss: 0.635815, Time/step: 1.115812
2024-08-20 03:37:10,068:INFO: {'sim_loss': 0.6386928558349609, 'siou_loss': 0.1332477331161499, 'loss': 0.7053167223930359}
2024-08-20 03:37:10,071:INFO: Epoch: 5/5, Step: 588/703, Lr: 0.000000000-0.000002639-0.000127780, Loss: 0.705317, Time/step: 1.094444
2024-08-20 03:37:20,940:INFO: {'sim_loss': 0.589447557926178, 'siou_loss': 0.13118809461593628, 'loss': 0.6550415754318237}
2024-08-20 03:37:20,943:INFO: Epoch: 5/5, Step: 598/703, Lr: 0.000000000-0.000002200-0.000124812, Loss: 0.655042, Time/step: 1.087250
2024-08-20 03:37:31,882:INFO: {'sim_loss': 0.5104092359542847, 'siou_loss': 0.13415950536727905, 'loss': 0.5774890184402466}
2024-08-20 03:37:31,885:INFO: Epoch: 5/5, Step: 608/703, Lr: 0.000000000-0.000001801-0.000121873, Loss: 0.577489, Time/step: 1.094113
2024-08-20 03:37:42,743:INFO: {'sim_loss': 0.5694479942321777, 'siou_loss': 0.13364410400390625, 'loss': 0.6362700462341309}
2024-08-20 03:37:42,745:INFO: Epoch: 5/5, Step: 618/703, Lr: 0.000000000-0.000001442-0.000118964, Loss: 0.636270, Time/step: 1.086047
2024-08-20 03:37:53,741:INFO: {'sim_loss': 0.4807199239730835, 'siou_loss': 0.13468286395072937, 'loss': 0.5480613708496094}
2024-08-20 03:37:53,745:INFO: Epoch: 5/5, Step: 628/703, Lr: 0.000000000-0.000001123-0.000116086, Loss: 0.548061, Time/step: 1.099890
2024-08-20 03:38:04,722:INFO: {'sim_loss': 0.536658525466919, 'siou_loss': 0.13192233443260193, 'loss': 0.6026197075843811}
2024-08-20 03:38:04,724:INFO: Epoch: 5/5, Step: 638/703, Lr: 0.000000000-0.000000844-0.000113238, Loss: 0.602620, Time/step: 1.097955
2024-08-20 03:38:15,814:INFO: {'sim_loss': 0.5532208681106567, 'siou_loss': 0.13537448644638062, 'loss': 0.6209081411361694}
2024-08-20 03:38:15,817:INFO: Epoch: 5/5, Step: 648/703, Lr: 0.000000000-0.000000604-0.000110421, Loss: 0.620908, Time/step: 1.109242
2024-08-20 03:38:26,554:INFO: {'sim_loss': 0.6370190382003784, 'siou_loss': 0.1348716914653778, 'loss': 0.7044548988342285}
2024-08-20 03:38:26,557:INFO: Epoch: 5/5, Step: 658/703, Lr: 0.000000000-0.000000404-0.000107636, Loss: 0.704455, Time/step: 1.073970
2024-08-20 03:38:37,388:INFO: {'sim_loss': 0.48879846930503845, 'siou_loss': 0.13501834869384766, 'loss': 0.5563076734542847}
2024-08-20 03:38:37,391:INFO: Epoch: 5/5, Step: 668/703, Lr: 0.000000000-0.000000245-0.000104881, Loss: 0.556308, Time/step: 1.083415
2024-08-20 03:38:48,172:INFO: {'sim_loss': 0.6859867572784424, 'siou_loss': 0.13471683859825134, 'loss': 0.7533451914787292}
2024-08-20 03:38:48,177:INFO: Epoch: 5/5, Step: 678/703, Lr: 0.000000000-0.000000125-0.000102159, Loss: 0.753345, Time/step: 1.078570
2024-08-20 03:38:59,080:INFO: {'sim_loss': 0.6402984857559204, 'siou_loss': 0.13268080353736877, 'loss': 0.7066388726234436}
2024-08-20 03:38:59,084:INFO: Epoch: 5/5, Step: 688/703, Lr: 0.000000000-0.000000045-0.000099468, Loss: 0.706639, Time/step: 1.090719
2024-08-20 03:39:09,379:INFO: {'sim_loss': 0.5250621438026428, 'siou_loss': 0.133560448884964, 'loss': 0.5918423533439636}
2024-08-20 03:39:09,381:INFO: Epoch: 5/5, Step: 698/703, Lr: 0.000000000-0.000000005-0.000096809, Loss: 0.591842, Time/step: 1.029651
2024-08-20 03:39:14,817:INFO: Eval on val dataset
2024-08-20 03:39:14,818:INFO: Epoch 5/5 Finished, Train Loss: 0.610715
2024-08-20 03:39:14,818:INFO: Eval on val dataset
2024-08-20 03:39:26,040:INFO: sim matrix size: 1000, 1000
2024-08-20 03:39:26,141:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 03:39:26,141:INFO: 	>>>[3515][constrast] Text-to-Video  R@1: 47.4 - R@5: 74.4 - R@10: 83.4 - Median R: 2.0 - Mean R: 13.5
2024-08-20 03:39:26,142:INFO: 	>>> [3515][constrast] V2T$R@1: 46.5 - V2T$R@5: 73.7 - V2T$R@10: 83.0 - V2T$Median R: 2.0 - V2T$Mean R: 9.7
2024-08-20 03:39:26,143:INFO: The best model is: outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth, the R1 is: 47.8000
2024-08-20 03:39:26,369:INFO: Model loaded from outputs/test2/mw0.5-sep1-thresh0.7/best_model.pth
2024-08-20 03:39:27,908:INFO: loading archive file /data2/dengrui/projects_opensource/hc-align/modules/cross-base
2024-08-20 03:39:27,908:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-08-20 03:39:27,908:INFO: Weight doesn't exsits. /data2/dengrui/projects_opensource/hc-align/modules/cross-base/cross_pytorch_model.bin
2024-08-20 03:39:27,909:WARNING: 	 embed_dim: 512
2024-08-20 03:39:27,909:WARNING: 	 image_resolution: 224
2024-08-20 03:39:27,909:WARNING: 	 vision_layers: 12
2024-08-20 03:39:27,909:WARNING: 	 vision_width: 768
2024-08-20 03:39:27,909:WARNING: 	 vision_patch_size: 32
2024-08-20 03:39:27,909:WARNING: 	 context_length: 77
2024-08-20 03:39:27,909:WARNING: 	 vocab_size: 49408
2024-08-20 03:39:27,909:WARNING: 	 transformer_width: 512
2024-08-20 03:39:27,909:WARNING: 	 transformer_heads: 8
2024-08-20 03:39:27,909:WARNING: 	 transformer_layers: 12
2024-08-20 03:39:27,909:WARNING: 		 linear_patch: 2d
2024-08-20 03:39:27,909:WARNING: 	 cut_top_layer: 0
2024-08-20 03:39:29,696:WARNING: 	 sim_header: seqTransf
2024-08-20 03:39:29,696:WARNING: Set cross_config.num_hidden_layers: 4.
2024-08-20 03:39:29,983:INFO: --------------------
2024-08-20 03:39:29,983:INFO: Weights from pretrained model not used in HcAlign: 
   clip.input_resolution
   clip.context_length
   clip.vocab_size
2024-08-20 03:39:40,866:INFO: sim matrix size: 1000, 1000
2024-08-20 03:39:40,966:INFO: 	 Length-T: 1000, Length-V:1000
2024-08-20 03:39:40,966:INFO: 	>>>[0][constrast] Text-to-Video  R@1: 48.6 - R@5: 74.2 - R@10: 83.5 - Median R: 2.0 - Mean R: 13.5
2024-08-20 03:39:40,966:INFO: 	>>> [0][constrast] V2T$R@1: 47.7 - V2T$R@5: 74.7 - V2T$R@10: 84.0 - V2T$Median R: 2.0 - V2T$Mean R: 9.6
